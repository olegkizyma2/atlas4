# Setup Script Fixes - 16.10.2025

## ‚úÖ –í–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –∑–∞—Å—Ç–æ—Å–æ–≤–∞–Ω–æ

### 1. üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç—É - .md —Ñ–∞–π–ª–∏ –ø–µ—Ä–µ–º—ñ—â–µ–Ω–æ –≤ docs/

**–ü—Ä–æ–±–ª–µ–º–∞:** .md —Ñ–∞–π–ª–∏ –∑–Ω–∞—Ö–æ–¥–∏–ª–∏—Å—å —É –∫–æ—Ä–µ–Ω—ñ –ø—Ä–æ–µ–∫—Ç—É

**–í–∏–ø—Ä–∞–≤–ª–µ–Ω–æ:**
```bash
# –ü–µ—Ä–µ–º—ñ—â–µ–Ω–æ –∑ root/ –≤ docs/:
REFACTORING_SUMMARY.md ‚Üí docs/
MIGRATION_v5.md ‚Üí docs/
MIGRATION.md ‚Üí docs/
copilot.md ‚Üí docs/

# –ó–∞–ª–∏—à–∏–≤—Å—è –≤ –∫–æ—Ä–µ–Ω—ñ (–ø—Ä–∞–≤–∏–ª—å–Ω–æ):
README.md ‚úÖ
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
atlas4/
‚îú‚îÄ‚îÄ README.md                    # ‚úÖ –ì–æ–ª–æ–≤–Ω–∏–π —Ñ–∞–π–ª (–∑–∞–ª–∏—à–∞—î—Ç—å—Å—è –≤ –∫–æ—Ä–µ–Ω—ñ)
‚îú‚îÄ‚îÄ docs/
‚îÇ   ‚îú‚îÄ‚îÄ REFACTORING_SUMMARY.md  # ‚úÖ –ü–µ—Ä–µ–Ω–µ—Å–µ–Ω–æ
‚îÇ   ‚îú‚îÄ‚îÄ MIGRATION_v5.md         # ‚úÖ –ü–µ—Ä–µ–Ω–µ—Å–µ–Ω–æ
‚îÇ   ‚îú‚îÄ‚îÄ MIGRATION.md            # ‚úÖ –ü–µ—Ä–µ–Ω–µ—Å–µ–Ω–æ
‚îÇ   ‚îî‚îÄ‚îÄ copilot.md              # ‚úÖ –ü–µ—Ä–µ–Ω–µ—Å–µ–Ω–æ
```

---

### 2. ‚ùå Goose –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –≤–∏–¥–∞–ª–µ–Ω–∞ –∑—ñ setup-macos.sh

**–ü—Ä–æ–±–ª–µ–º–∞:** Setup –ø–µ—Ä–µ–≤—ñ—Ä—è–≤ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å Goose —ñ –ø–æ–∫–∞–∑—É–≤–∞–≤ ERROR, 
—Ö–æ—á–∞ Goose deprecated –≤ v5.0

**–ë—É–ª–æ:**
```bash
# Goose
if [ -n "$GOOSE_BIN" ] && [ -x "$GOOSE_BIN" ]; then
    log_success "Goose: –¥–æ—Å—Ç—É–ø–Ω–∏–π"
else
    log_error "Goose –Ω–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ"  # ‚ùå ERROR —è–∫–∏–π –Ω–µ –º–∞—î –±—É—Ç–∏
    all_ok=false
fi
```

**–°—Ç–∞–ª–æ:**
```bash
# Goose - DEPRECATED –≤ v5.0 (Pure MCP mode)
# Goose integration –≤–∏–¥–∞–ª–µ–Ω–æ –∑ ATLAS v5.0
log_info "Goose: –Ω–µ –ø–æ—Ç—Ä—ñ–±–µ–Ω (v5.0 Pure MCP mode)"
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –ù–µ–º–∞—î –ø–æ–º–∏–ª–æ–∫ –ø—Ä–æ –≤—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å Goose
- ‚úÖ –ß—ñ—Ç–∫–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —â–æ Goose deprecated
- ‚úÖ Setup –∑–∞–≤–µ—Ä—à—É—î—Ç—å—Å—è –±–µ–∑ –ø–æ–º–∏–ª–æ–∫

**–§–∞–π–ª:** `setup-macos.sh` (lines ~1030-1037)

---

### 3. üîÑ Restart System Behavior - –ü—Ä–∞–≤–∏–ª—å–Ω–∞ –ª–æ–≥—ñ–∫–∞

**–ü–∏—Ç–∞–Ω–Ω—è:** –ß–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–∏—Å—Ç–µ–º—É –ø—Ä–∏ `./restart_system.sh start` 
—è–∫—â–æ –≤–æ–Ω–∞ –≤–∂–µ –∑–∞–ø—É—â–µ–Ω–∞?

**–í—ñ–¥–ø–æ–≤—ñ–¥—å:** **–ù–Ü**, `start` –ù–ï –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞—î –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ.

**–õ–æ–≥—ñ–∫–∞ –∫–æ–º–∞–Ω–¥:**

#### `./restart_system.sh start`
```bash
cmd_start() {
    # 1. –°—Ç–≤–æ—Ä—é—î –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—ó
    init_directories
    
    # 2. –ó–∞–ø—É—Å–∫–∞—î —Å–µ—Ä–≤—ñ—Å–∏
    start_tts_service
    start_whisper_service
    start_orchestrator
    start_frontend
    start_recovery_bridge
    start_fallback_llm
    
    # 3. –ü–µ—Ä–µ–≤—ñ—Ä—è—î —Å—Ç–∞—Ç—É—Å
    cmd_status
}
```
**–ü–æ–≤–µ–¥—ñ–Ω–∫–∞:** –Ø–∫—â–æ —Å–µ—Ä–≤—ñ—Å–∏ –≤–∂–µ –∑–∞–ø—É—â–µ–Ω—ñ - —Å–ø—Ä–æ–±—É—î –∑–∞–ø—É—Å—Ç–∏—Ç–∏ —â–µ —Ä–∞–∑
(–º–æ–∂–µ –±—É—Ç–∏ –∫–æ–Ω—Ñ–ª—ñ–∫—Ç –ø–æ—Ä—Ç—ñ–≤)

#### `./restart_system.sh restart`
```bash
cmd_restart() {
    cmd_stop          # 1. –ó—É–ø–∏–Ω—è—î –í–°–Ü —Å–µ—Ä–≤—ñ—Å–∏
    sleep 5           # 2. –ß–µ–∫–∞—î 5 —Å–µ–∫—É–Ω–¥
    cmd_start         # 3. –ó–∞–ø—É—Å–∫–∞—î –∑–∞–Ω–æ–≤–æ
}
```
**–ü–æ–≤–µ–¥—ñ–Ω–∫–∞:** –ì–∞—Ä–∞–Ω—Ç–æ–≤–∞–Ω–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞—î - —Å–ø–æ—á–∞—Ç–∫—É –∑—É–ø–∏–Ω—è—î, –ø–æ—Ç—ñ–º –∑–∞–ø—É—Å–∫–∞—î

#### `./restart_system.sh stop`
```bash
cmd_stop() {
    # –ó—É–ø–∏–Ω—è—î –≤—Å—ñ —Å–µ—Ä–≤—ñ—Å–∏ –ø–æ PID files
    stop_service "Recovery Bridge" "$LOGS_DIR/recovery.pid"
    stop_service "Frontend" "$LOGS_DIR/frontend.pid"
    stop_service "Orchestrator" "$LOGS_DIR/orchestrator.pid"
    stop_service "Whisper Service" "$LOGS_DIR/whisper.pid"
    stop_service "TTS Service" "$LOGS_DIR/tts.pid"
    # ... —Ä–µ—à—Ç–∞ —Å–µ—Ä–≤—ñ—Å—ñ–≤
}
```

---

### üìã –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

#### ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∏–π workflow:

**–ü–µ—Ä—à–∏–π –∑–∞–ø—É—Å–∫:**
```bash
./restart_system.sh start
```

**–Ø–∫—â–æ —Å–∏—Å—Ç–µ–º–∞ –≤–∂–µ –∑–∞–ø—É—â–µ–Ω–∞ —ñ —Ç—Ä–µ–±–∞ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–∏:**
```bash
./restart_system.sh restart  # ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ
```

**–ê–ë–û –æ–∫—Ä–µ–º–æ:**
```bash
./restart_system.sh stop     # –ó—É–ø–∏–Ω–∏—Ç–∏
# –ó–º—ñ–Ω–∏ –≤ –∫–æ–¥—ñ...
./restart_system.sh start    # –ó–∞–ø—É—Å—Ç–∏—Ç–∏ –∑–∞–Ω–æ–≤–æ
```

**–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å—É:**
```bash
./restart_system.sh status
```

**–õ–æ–≥–∏:**
```bash
./restart_system.sh logs              # –í—Å—ñ –ª–æ–≥–∏
./restart_system.sh logs orchestrator # –ö–æ–Ω–∫—Ä–µ—Ç–Ω–∏–π —Å–µ—Ä–≤—ñ—Å
```

#### ‚ùå –ù–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è:

```bash
# –Ø–∫—â–æ —Å–∏—Å—Ç–µ–º–∞ –≤–∂–µ –∑–∞–ø—É—â–µ–Ω–∞:
./restart_system.sh start  # ‚ùå –ú–æ–∂–µ –±—É—Ç–∏ –∫–æ–Ω—Ñ–ª—ñ–∫—Ç –ø–æ—Ä—Ç—ñ–≤

# –ù–∞—Ç–æ–º—ñ—Å—Ç—å:
./restart_system.sh restart  # ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ
```

---

### üéØ –ü—ñ–¥—Å—É–º–æ–∫ –∑–º—ñ–Ω

| –ó–º—ñ–Ω–∞                | –°—Ç–∞—Ç—É—Å       | –§–∞–π–ª              |
| -------------------- | ------------ | ----------------- |
| .md —Ñ–∞–π–ª–∏ –≤ docs/    | ‚úÖ –í–∏–ø—Ä–∞–≤–ª–µ–Ω–æ | root ‚Üí docs/      |
| Goose ERROR –≤–∏–¥–∞–ª–µ–Ω–æ | ‚úÖ –í–∏–ø—Ä–∞–≤–ª–µ–Ω–æ | setup-macos.sh    |
| Restart –ª–æ–≥—ñ–∫–∞       | ‚úÖ –ü–µ—Ä–µ–≤—ñ—Ä–µ–Ω–æ | restart_system.sh |

**–í—Å—ñ –∑–º—ñ–Ω–∏ –∑–∞—Å—Ç–æ—Å–æ–≤–∞–Ω–æ —É—Å–ø—ñ—à–Ω–æ!** ‚ú®

---

## üìö –î–æ–¥–∞—Ç–∫–æ–≤–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–º–∞–Ω–¥ restart_system.sh:

```
restart_system.sh
‚îú‚îÄ‚îÄ start      ‚Üí –ó–∞–ø—É—Å—Ç–∏—Ç–∏ (–±–µ–∑ –∑—É–ø–∏–Ω–∫–∏)
‚îú‚îÄ‚îÄ stop       ‚Üí –ó—É–ø–∏–Ω–∏—Ç–∏ –≤—Å–µ
‚îú‚îÄ‚îÄ restart    ‚Üí –ó—É–ø–∏–Ω–∏—Ç–∏ + –ó–∞–ø—É—Å—Ç–∏—Ç–∏
‚îú‚îÄ‚îÄ status     ‚Üí –ü–æ–∫–∞–∑–∞—Ç–∏ —Å—Ç–∞—Ç—É—Å
‚îú‚îÄ‚îÄ logs       ‚Üí –ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ –ª–æ–≥–∏
‚îú‚îÄ‚îÄ clean      ‚Üí –û—á–∏—Å—Ç–∏—Ç–∏ —Å—Ç–∞—Ä—ñ –ª–æ–≥–∏
‚îú‚îÄ‚îÄ diagnose   ‚Üí –î—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å–∏—Å—Ç–µ–º–∏
‚îî‚îÄ‚îÄ help       ‚Üí –î–æ–ø–æ–º–æ–≥–∞
```

### Environment Variables:

```bash
REAL_TTS_MODE=true              # –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ Ukrainian TTS
TTS_DEVICE=mps                  # Metal GPU –¥–ª—è TTS
WHISPER_DEVICE=metal            # Metal GPU –¥–ª—è Whisper
USE_METAL_GPU=true              # Metal GPU acceleration
OPTIMIZE_FOR_M1_MAX=true        # M1 Max –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó
FORCE_FREE_PORTS=false          # –ü—Ä–∏–º—É—Å–æ–≤–æ –∑–≤—ñ–ª—å–Ω—è—Ç–∏ –ø–æ—Ä—Ç–∏
```

---

**–î–∞—Ç–∞:** 16 –∂–æ–≤—Ç–Ω—è 2025 —Ä.  
**–í–µ—Ä—Å—ñ—è:** ATLAS v5.0 Pure MCP Edition
