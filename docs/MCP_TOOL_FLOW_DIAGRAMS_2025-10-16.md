# ğŸ”„ MCP Tool Flow: Ğ”Ğ¸Ğ°Ğ³Ñ€Ğ°Ğ¼Ğ¼Ñ‹ Ğ¸ Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸

## Ğ”Ğ¸Ğ°Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğ° 1: ĞŸĞ¾Ğ»Ğ½Ñ‹Ğ¹ Ñ†Ğ¸ĞºĞ» tool-based Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ñ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     MCP Tool Execution Cycle                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  PHASE 1: PLANNING (Tetyana)                                         â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                    â”‚
â”‚                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                â”‚
â”‚  â”‚   TODO Item & Success Criteria  â”‚                                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                â”‚
â”‚                   â”‚                                                  â”‚
â”‚                   â–¼                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                â”‚
â”‚  â”‚ MCPManager.getToolsSummary()    â”‚  getAvailableTools() Ğ¸Ğ»Ğ¸      â”‚
â”‚  â”‚ (92 tools formatted as text)    â”‚  getDetailedToolsSummary()    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                â”‚
â”‚                   â”‚                                                  â”‚
â”‚                   â–¼                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚ tetyana_plan_tools.js (Prompt)                      â”‚            â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚            â”‚
â”‚  â”‚ â”‚ System: You are Tetyana...                      â”‚ â”‚            â”‚
â”‚  â”‚ â”‚                                                 â”‚ â”‚            â”‚
â”‚  â”‚ â”‚ Available MCP Tools:                            â”‚ â”‚            â”‚
â”‚  â”‚ â”‚ {{AVAILABLE_TOOLS}} â† 92+ tools text here!     â”‚ â”‚            â”‚
â”‚  â”‚ â”‚                                                 â”‚ â”‚            â”‚
â”‚  â”‚ â”‚ Examples:                                       â”‚ â”‚            â”‚
â”‚  â”‚ â”‚ - shell.execute_command                         â”‚ â”‚            â”‚
â”‚  â”‚ â”‚ - playwright.screenshot                         â”‚ â”‚            â”‚
â”‚  â”‚ â”‚ - filesystem.write_file                         â”‚ â”‚            â”‚
â”‚  â”‚ â”‚                                                 â”‚ â”‚            â”‚
â”‚  â”‚ â”‚ Return ONLY JSON with tool_calls array          â”‚ â”‚            â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚            â”‚
â”‚  â”‚ User: Open calculator, compute 333Ã—2=666           â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                   â”‚                                                  â”‚
â”‚                   â–¼                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                â”‚
â”‚  â”‚ LLM @ localhost:4000            â”‚                                â”‚
â”‚  â”‚ (gpt-4o-mini, T=0.3)            â”‚                                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                â”‚
â”‚                   â”‚                                                  â”‚
â”‚                   â–¼                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚  â”‚ Tetyana's Tool Plan (JSON):                 â”‚                    â”‚
â”‚  â”‚ {                                           â”‚                    â”‚
â”‚  â”‚   "tool_calls": [                           â”‚                    â”‚
â”‚  â”‚     {"server":"applescript","tool":...},    â”‚                    â”‚
â”‚  â”‚     {"server":"shell","tool":...},          â”‚                    â”‚
â”‚  â”‚     {"server":"playwright","tool":...}      â”‚                    â”‚
â”‚  â”‚   ]                                         â”‚                    â”‚
â”‚  â”‚ }                                           â”‚                    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚                   â”‚                                                  â”‚
â”‚  PHASE 2: EXECUTION (Tetyana)                                        â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                     â”‚
â”‚                   â”‚                                                  â”‚
â”‚                   â–¼                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                â”‚
â”‚  â”‚ For each tool_call in plan:     â”‚                                â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                                â”‚
â”‚  â”‚ â”‚ server: "shell"               â”‚                                â”‚
â”‚  â”‚ â”‚ tool: "execute_command"       â”‚                                â”‚
â”‚  â”‚ â”‚ params: {command: "..."}      â”‚                                â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                â”‚
â”‚                   â”‚                                                  â”‚
â”‚                   â–¼                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                â”‚
â”‚  â”‚ MCPManager.executeTool()        â”‚                                â”‚
â”‚  â”‚ (stdio to shell server)          â”‚                                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                â”‚
â”‚                   â”‚                                                  â”‚
â”‚                   â–¼                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                â”‚
â”‚  â”‚ Tool Result:                    â”‚                                â”‚
â”‚  â”‚ {success: true, result: {...}}  â”‚                                â”‚
â”‚  â”‚ {success: false, error: "..."}  â”‚                                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                â”‚
â”‚                   â”‚                                                  â”‚
â”‚                   â–¼                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚  â”‚ Execution Results Collected:                â”‚                    â”‚
â”‚  â”‚ {                                           â”‚                    â”‚
â”‚  â”‚   "results": [                              â”‚                    â”‚
â”‚  â”‚     {tool: "...", success: true, result:{}},â”‚                    â”‚
â”‚  â”‚     {tool: "...", success: true, result:{}} â”‚                    â”‚
â”‚  â”‚   ],                                        â”‚                    â”‚
â”‚  â”‚   "all_successful": true                    â”‚                    â”‚
â”‚  â”‚ }                                           â”‚                    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚                   â”‚                                                  â”‚
â”‚  PHASE 3: VERIFICATION PLANNING (Grisha)                             â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                              â”‚
â”‚                   â”‚                                                  â”‚
â”‚                   â–¼                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚  â”‚ Grisha gets Tetyana's execution      â”‚                           â”‚
â”‚  â”‚ results + success criteria           â”‚                           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â”‚                   â”‚                                                  â”‚
â”‚                   â–¼                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚  â”‚ grisha_verify_item.js (Prompt)       â”‚                           â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚                           â”‚
â”‚  â”‚ â”‚ System: You are Grisha...        â”‚ â”‚                           â”‚
â”‚  â”‚ â”‚                                  â”‚ â”‚                           â”‚
â”‚  â”‚ â”‚ âš ï¸ MANDATORY: screenshot always! â”‚ â”‚                           â”‚
â”‚  â”‚ â”‚                                  â”‚ â”‚                           â”‚
â”‚  â”‚ â”‚ Available Tools:                 â”‚ â”‚                           â”‚
â”‚  â”‚ â”‚ {{AVAILABLE_TOOLS}} â† tools      â”‚ â”‚                           â”‚
â”‚  â”‚ â”‚ Available for verification       â”‚ â”‚                           â”‚
â”‚  â”‚ â”‚                                  â”‚ â”‚                           â”‚
â”‚  â”‚ â”‚ Return ONLY JSON with            â”‚ â”‚                           â”‚
â”‚  â”‚ â”‚ verification tool_calls          â”‚ â”‚                           â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                           â”‚
â”‚  â”‚ User: Verify calc shows 333Ã—2=666    â”‚                           â”‚
â”‚  â”‚       Evidence: [results]            â”‚                           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â”‚                   â”‚                                                  â”‚
â”‚                   â–¼                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚  â”‚ LLM @ localhost:4000                 â”‚                           â”‚
â”‚  â”‚ (gpt-4o-mini, T=0.3)                 â”‚                           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â”‚                   â”‚                                                  â”‚
â”‚                   â–¼                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚  â”‚ Grisha's Verification Plan:          â”‚                           â”‚
â”‚  â”‚ {                                    â”‚                           â”‚
â”‚  â”‚   "tool_calls": [                    â”‚                           â”‚
â”‚  â”‚     {"server": "shell",              â”‚                           â”‚
â”‚  â”‚      "tool": "execute_command",      â”‚                           â”‚
â”‚  â”‚      "params": {"command":           â”‚                           â”‚
â”‚  â”‚        "screencapture /tmp/v.png"}}, â”‚                           â”‚
â”‚  â”‚     {"server": "shell", ...}         â”‚                           â”‚
â”‚  â”‚   ]                                  â”‚                           â”‚
â”‚  â”‚ }                                    â”‚                           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â”‚                   â”‚                                                  â”‚
â”‚  PHASE 4: VERIFICATION EXECUTION (Grisha)                            â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                            â”‚
â”‚                   â”‚                                                  â”‚
â”‚                   â–¼                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚  â”‚ For each verification tool_call:     â”‚                           â”‚
â”‚  â”‚ MCPManager.executeTool()              â”‚                           â”‚
â”‚  â”‚                                      â”‚                           â”‚
â”‚  â”‚ Results include:                     â”‚                           â”‚
â”‚  â”‚ - screenshot.png (binary data)       â”‚                           â”‚
â”‚  â”‚ - file contents (text)               â”‚                           â”‚
â”‚  â”‚ - command output                     â”‚                           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â”‚                   â”‚                                                  â”‚
â”‚  PHASE 5: VERIFICATION ANALYSIS (Grisha)                             â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                              â”‚
â”‚                   â”‚                                                  â”‚
â”‚                   â–¼                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚  â”‚ LLM Analysis:                            â”‚                       â”‚
â”‚  â”‚ - Read REAL screenshot image data        â”‚                       â”‚
â”‚  â”‚ - Compare to success criteria            â”‚                       â”‚
â”‚  â”‚ - Make YES/NO decision                   â”‚                       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚                   â”‚                                                  â”‚
â”‚                   â–¼                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚  â”‚ FINAL DECISION:                          â”‚                       â”‚
â”‚  â”‚ {                                        â”‚                       â”‚
â”‚  â”‚   "verified": true/false,                â”‚                       â”‚
â”‚  â”‚   "reason": "Screenshot shows 333Ã—2=666" â”‚                       â”‚
â”‚  â”‚ }                                        â”‚                       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Ğ”Ğ¸Ğ°Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğ° 2: Data Structure Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ INPUT: TODO Item                                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ {                                                               â”‚
â”‚   "id": "item_1",                                               â”‚
â”‚   "action": "Open calculator and compute 333Ã—2=666",           â”‚
â”‚   "success_criteria": "Result shows 666",                       â”‚
â”‚   "dependencies": [],                                           â”‚
â”‚   "max_attempts": 3                                             â”‚
â”‚ }                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ planTools()      â”‚
                    â”‚ (Tetyana thinks) â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PLANNING OUTPUT: Tool Plan                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ {                                                               â”‚
â”‚   "tool_calls": [                                               â”‚
â”‚     {                                                           â”‚
â”‚       "server": "applescript",                                  â”‚
â”‚       "tool": "applescript_execute",                            â”‚
â”‚       "parameters": {                                           â”‚
â”‚         "code_snippet": "tell app \"Calculator\" to activate"   â”‚
â”‚       }                                                         â”‚
â”‚     },                                                          â”‚
â”‚     {                                                           â”‚
â”‚       "server": "shell",                                        â”‚
â”‚       "tool": "execute_command",                                â”‚
â”‚       "parameters": {                                           â”‚
â”‚         "command": "osascript -e 'tell app ...' && sleep 1"    â”‚
â”‚       }                                                         â”‚
â”‚     }                                                           â”‚
â”‚   ],                                                            â”‚
â”‚   "reasoning": "First activate app, then take screenshot"      â”‚
â”‚ }                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ executeTools()    â”‚
                    â”‚ (Tetyana acts)    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ EXECUTION OUTPUT: Execution Results                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ {                                                               â”‚
â”‚   "results": [                                                  â”‚
â”‚     {                                                           â”‚
â”‚       "tool": "applescript_execute",                            â”‚
â”‚       "server": "applescript",                                  â”‚
â”‚       "success": true,                                          â”‚
â”‚       "result": {"status": "App activated"}                     â”‚
â”‚     },                                                          â”‚
â”‚     {                                                           â”‚
â”‚       "tool": "execute_command",                                â”‚
â”‚       "server": "shell",                                        â”‚
â”‚       "success": true,                                          â”‚
â”‚       "result": {                                               â”‚
â”‚         "stdout": "Screenshot saved to /tmp/calc.png",         â”‚
â”‚         "stderr": "",                                           â”‚
â”‚         "exit_code": 0                                          â”‚
â”‚       }                                                         â”‚
â”‚     }                                                           â”‚
â”‚   ],                                                            â”‚
â”‚   "all_successful": true,                                       â”‚
â”‚   "tts_phrase": "ĞšĞ°Ğ»ÑŒĞºÑƒĞ»ÑÑ‚Ğ¾Ñ€ Ğ¾Ñ‚ĞºÑ€Ñ‹Ñ‚, ÑĞºÑ€Ğ¸Ğ½ÑˆĞ¾Ñ‚ ÑĞ´ĞµĞ»Ğ°Ğ½"        â”‚
â”‚ }                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚ _planVerificationToolsâ”‚
                   â”‚ (Grisha plans check) â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ VERIFICATION PLAN: What to check                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ {                                                               â”‚
â”‚   "tool_calls": [                                               â”‚
â”‚     {                                                           â”‚
â”‚       "server": "shell",                                        â”‚
â”‚       "tool": "execute_command",                                â”‚
â”‚       "parameters": {                                           â”‚
â”‚         "command": "screencapture -x /tmp/verify.png"          â”‚
â”‚       }                                                         â”‚
â”‚     },                                                          â”‚
â”‚     {                                                           â”‚
â”‚       "server": "filesystem",                                   â”‚
â”‚       "tool": "read_file",                                      â”‚
â”‚       "parameters": {                                           â”‚
â”‚         "path": "/tmp/verify.png"                              â”‚
â”‚       }                                                         â”‚
â”‚     }                                                           â”‚
â”‚   ],                                                            â”‚
â”‚   "screenshot_required": true                                   â”‚
â”‚ }                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚ _executeVerificationTools â”‚
                â”‚ (Grisha gets evidence)    â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ VERIFICATION RESULTS: REAL DATA!                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ {                                                                â”‚
â”‚   "results": [                                                   â”‚
â”‚     {                                                            â”‚
â”‚       "tool": "execute_command",                                 â”‚
â”‚       "server": "shell",                                         â”‚
â”‚       "success": true,                                           â”‚
â”‚       "result": {"stdout": "", "stderr": ""}                     â”‚
â”‚     },                                                           â”‚
â”‚     {                                                            â”‚
â”‚       "tool": "read_file",                                       â”‚
â”‚       "server": "filesystem",                                    â”‚
â”‚       "success": true,                                           â”‚
â”‚       "result": {                                                â”‚
â”‚         "content": "PNG_BINARY_DATA...",  â† REAL screenshot!     â”‚
â”‚         "size": 15234,                                           â”‚
â”‚         "encoding": "binary"                                     â”‚
â”‚       }                                                          â”‚
â”‚     }                                                            â”‚
â”‚   ]                                                              â”‚
â”‚ }                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ _analyzeVerificationResults  â”‚
              â”‚ (Grisha analyzes evidence)   â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FINAL DECISION: VERIFIED / NOT VERIFIED                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ {                                                             â”‚
â”‚   "verified": false,  â† Based on REAL screenshot analysis!    â”‚
â”‚   "reason": "Screenshot shows 333Ã—333=333,333,333 âŒ",        â”‚
â”‚   "expected": "333Ã—2=666",                                    â”‚
â”‚   "confidence": 0.95                                          â”‚
â”‚ }                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Ğ”Ğ¸Ğ°Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğ° 3: MCP Manager Tool Distribution

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     6 MCP SERVERS                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                    â”‚
â”‚  1ï¸âƒ£  SHELL SERVER (9 tools)                                       â”‚
â”‚  â”œâ”€ execute_command                                               â”‚
â”‚  â”œâ”€ get_platform_info                                             â”‚
â”‚  â”œâ”€ get_whitelist                                                 â”‚
â”‚  â”œâ”€ add_to_whitelist                                              â”‚
â”‚  â”œâ”€ approve_command                                               â”‚
â”‚  â”œâ”€ deny_command                                                  â”‚
â”‚  â”œâ”€ run_shell_command                                             â”‚
â”‚  â”œâ”€ run_applescript                                               â”‚
â”‚  â””â”€ get_working_directory                                         â”‚
â”‚                                                                    â”‚
â”‚  2ï¸âƒ£  FILESYSTEM SERVER (14 tools)                                 â”‚
â”‚  â”œâ”€ read_file                                                     â”‚
â”‚  â”œâ”€ write_file                                                    â”‚
â”‚  â”œâ”€ list_directory                                                â”‚
â”‚  â”œâ”€ create_directory                                              â”‚
â”‚  â”œâ”€ delete_file                                                   â”‚
â”‚  â”œâ”€ delete_directory                                              â”‚
â”‚  â”œâ”€ get_file_info                                                 â”‚
â”‚  â”œâ”€ move_file                                                     â”‚
â”‚  â”œâ”€ copy_file                                                     â”‚
â”‚  â”œâ”€ search_files                                                  â”‚
â”‚  â”œâ”€ get_home_directory                                            â”‚
â”‚  â”œâ”€ get_current_directory                                         â”‚
â”‚  â”œâ”€ set_current_directory                                         â”‚
â”‚  â””â”€ read_file_lines                                               â”‚
â”‚                                                                    â”‚
â”‚  3ï¸âƒ£  PLAYWRIGHT SERVER (32 tools)                                 â”‚
â”‚  â”œâ”€ browser_launch                                                â”‚
â”‚  â”œâ”€ browser_close                                                 â”‚
â”‚  â”œâ”€ new_context                                                   â”‚
â”‚  â”œâ”€ new_page                                                      â”‚
â”‚  â”œâ”€ close_page                                                    â”‚
â”‚  â”œâ”€ navigate                                                      â”‚
â”‚  â”œâ”€ fill                                                          â”‚
â”‚  â”œâ”€ click                                                         â”‚
â”‚  â”œâ”€ type                                                          â”‚
â”‚  â”œâ”€ press                                                         â”‚
â”‚  â”œâ”€ screenshot                                                    â”‚
â”‚  â”œâ”€ get_text                                                      â”‚
â”‚  â”œâ”€ get_url                                                       â”‚
â”‚  â”œâ”€ get_title                                                     â”‚
â”‚  â”œâ”€ wait_for_element                                              â”‚
â”‚  â”œâ”€ evaluate                                                      â”‚
â”‚  â”œâ”€ add_init_script                                               â”‚
â”‚  â”œâ”€ remove_init_script                                            â”‚
â”‚  â”œâ”€ set_viewport_size                                             â”‚
â”‚  â”œâ”€ set_offline_mode                                              â”‚
â”‚  â”œâ”€ set_geolocation                                               â”‚
â”‚  â”œâ”€ set_permissions                                               â”‚
â”‚  â”œâ”€ grant_permissions                                             â”‚
â”‚  â”œâ”€ revoke_permissions                                            â”‚
â”‚  â”œâ”€ set_extra_http_headers                                        â”‚
â”‚  â”œâ”€ set_http_auth                                                 â”‚
â”‚  â”œâ”€ set_user_agent                                                â”‚
â”‚  â”œâ”€ set_color_scheme                                              â”‚
â”‚  â”œâ”€ set_timezone                                                  â”‚
â”‚  â”œâ”€ set_locale                                                    â”‚
â”‚  â”œâ”€ set_java_script_enabled                                       â”‚
â”‚  â””â”€ expose_function                                               â”‚
â”‚                                                                    â”‚
â”‚  4ï¸âƒ£  APPLESCRIPT SERVER (1 tool)                                  â”‚
â”‚  â””â”€ applescript_execute                                           â”‚
â”‚                                                                    â”‚
â”‚  5ï¸âƒ£  GIT SERVER (27 tools)                                        â”‚
â”‚  â”œâ”€ git_status                                                    â”‚
â”‚  â”œâ”€ git_add                                                       â”‚
â”‚  â”œâ”€ git_commit                                                    â”‚
â”‚  â”œâ”€ git_push                                                      â”‚
â”‚  â”œâ”€ git_pull                                                      â”‚
â”‚  â”œâ”€ git_branch                                                    â”‚
â”‚  â”œâ”€ git_checkout                                                  â”‚
â”‚  â”œâ”€ git_merge                                                     â”‚
â”‚  â”œâ”€ git_rebase                                                    â”‚
â”‚  â”œâ”€ git_stash                                                     â”‚
â”‚  â”œâ”€ git_log                                                       â”‚
â”‚  â”œâ”€ git_diff                                                      â”‚
â”‚  â”œâ”€ git_tag                                                       â”‚
â”‚  â”œâ”€ git_remote                                                    â”‚
â”‚  â”œâ”€ git_fetch                                                     â”‚
â”‚  â”œâ”€ git_clone                                                     â”‚
â”‚  â”œâ”€ git_init                                                      â”‚
â”‚  â”œâ”€ git_reset                                                     â”‚
â”‚  â”œâ”€ git_clean                                                     â”‚
â”‚  â”œâ”€ git_cherry_pick                                               â”‚
â”‚  â”œâ”€ git_blame                                                     â”‚
â”‚  â”œâ”€ git_show                                                      â”‚
â”‚  â”œâ”€ git_reflog                                                    â”‚
â”‚  â”œâ”€ git_worktree                                                  â”‚
â”‚  â”œâ”€ git_set_working_dir                                           â”‚
â”‚  â””â”€ git_clear_working_dir                                         â”‚
â”‚                                                                    â”‚
â”‚  6ï¸âƒ£  MEMORY SERVER (9 tools)                                      â”‚
â”‚  â”œâ”€ store_memory                                                  â”‚
â”‚  â”œâ”€ retrieve_memory                                               â”‚
â”‚  â”œâ”€ list_memories                                                 â”‚
â”‚  â”œâ”€ delete_memory                                                 â”‚
â”‚  â”œâ”€ update_memory                                                 â”‚
â”‚  â”œâ”€ search_memories                                               â”‚
â”‚  â”œâ”€ clear_all_memories                                            â”‚
â”‚  â”œâ”€ get_memory                                                    â”‚
â”‚  â””â”€ memory_info                                                   â”‚
â”‚                                                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ TOTAL: 92 Tools                                                   â”‚
â”‚ - Tetyana uses: Typically 5-10 tools per task                     â”‚
â”‚ - Grisha uses: Typically 2-5 tools for verification               â”‚
â”‚ - Optimization: Pre-select servers to reduce LLM prompt 90%       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Ğ”Ğ¸Ğ°Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğ° 4: Pre-Selected Servers Optimization

```
WITHOUT Optimization:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

planTools(item, todo, {})
  â†“
MCPManager.getToolsSummary()
  â†“
Returns ALL 92 tools in markdown format
  â†“
Prompt becomes ~500 tokens
  â†“
LLM processes large context
  â†“
Slower, more expensive


WITH Optimization (NEW - 16.10.2025):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

planTools(item, todo, {
  selectedServers: ['shell', 'playwright']
})
  â†“
MCPManager.getToolsFromServers(['shell', 'playwright'])
  â†“
Returns ONLY 40 tools (shell 9 + playwright 32)
  â†“
Prompt becomes ~150 tokens (70% reduction!)
  â†“
LLM processes focused context
  â†“
Faster, cheaper, more accurate


FLOW:
â”€â”€â”€â”€â”€

Stage 1 (Planning):
  â”œâ”€ Atlas analyzes task
  â”œâ”€ Determines which servers needed
  â””â”€ Returns selectedServers: ['shell', 'playwright']
  
Stage 2.0 (Server Selection):
  â”œâ”€ Pre-selects relevant servers
  â”œâ”€ Passes to Stage 2.1
  â””â”€ Avoids 92+ tools bombardment
  
Stage 2.1 (Tetyana Planning):
  â”œâ”€ Receives selectedServers parameter
  â”œâ”€ Calls MCPManager with filter
  â”œâ”€ Gets only 40 tools
  â”œâ”€ Gets ~150 token summary
  â””â”€ LLM plans with focused context
  
Stage 2.2 (Execution):
  â”œâ”€ Executes planned tools
  â””â”€ Results are specific and relevant
  
Stage 2.3 (Grisha Verification):
  â”œâ”€ Uses same selectedServers
  â”œâ”€ Gets focused verification tool set
  â””â”€ Verification is precise
```

---

## Ğ”Ğ¸Ğ°Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğ° 5: ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº Ğ¸ fallbacks

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         ERROR HANDLING IN MCP EXECUTION                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  EXECUTION ERROR                                        â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                       â”‚
â”‚         â”‚                                               â”‚
â”‚         â–¼                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚ catch (error) in executeTools()      â”‚               â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚               â”‚
â”‚  â”‚ â”‚ results.push({                   â”‚ â”‚               â”‚
â”‚  â”‚ â”‚   tool: toolCall.tool,           â”‚ â”‚               â”‚
â”‚  â”‚ â”‚   server: toolCall.server,       â”‚ â”‚               â”‚
â”‚  â”‚ â”‚   success: false,                â”‚ â”‚               â”‚
â”‚  â”‚ â”‚   error: error.message           â”‚ â”‚               â”‚
â”‚  â”‚ â”‚ })                               â”‚ â”‚               â”‚
â”‚  â”‚ â”‚ allSuccessful = false            â”‚ â”‚               â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚               â”‚
â”‚  â”‚ âœ… Continue with next tool!          â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚         â”‚                                               â”‚
â”‚         â–¼                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚ Return execution results:            â”‚               â”‚
â”‚  â”‚ {                                    â”‚               â”‚
â”‚  â”‚   results: [                         â”‚               â”‚
â”‚  â”‚     {success: true, ...},            â”‚               â”‚
â”‚  â”‚     {success: false, error: "..."},  â”‚               â”‚
â”‚  â”‚     {success: true, ...}             â”‚               â”‚
â”‚  â”‚   ],                                 â”‚               â”‚
â”‚  â”‚   all_successful: false  â† Key flag! â”‚               â”‚
â”‚  â”‚ }                                    â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚         â”‚                                               â”‚
â”‚         â–¼                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚ Grisha sees all_successful: false    â”‚               â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚               â”‚
â”‚  â”‚ â”‚ Plans verification with focus on â”‚ â”‚               â”‚
â”‚  â”‚ â”‚ FAILED tool results              â”‚ â”‚               â”‚
â”‚  â”‚ â”‚                                  â”‚ â”‚               â”‚
â”‚  â”‚ â”‚ "Tool X failed. Let me check..." â”‚ â”‚               â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚         â”‚                                               â”‚
â”‚         â–¼                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚ Verification reveals actual issue:   â”‚               â”‚
â”‚  â”‚ - Tool execution failed (network)    â”‚               â”‚
â”‚  â”‚ - Tool execution failed (syntax)     â”‚               â”‚
â”‚  â”‚ - Tool execution failed (permission) â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚         â”‚                                               â”‚
â”‚         â–¼                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚ Grisha's Decision:                   â”‚               â”‚
â”‚  â”‚ verified: false                      â”‚               â”‚
â”‚  â”‚ reason: "Tool failed, see details..."â”‚               â”‚
â”‚  â”‚ evidence: [actual error data]        â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚         â”‚                                               â”‚
â”‚         â–¼                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚ Retry Logic (up to 3 attempts):      â”‚               â”‚
â”‚  â”‚ - Attempt 1: Failed                  â”‚               â”‚
â”‚  â”‚ - Attempt 2: Failed                  â”‚               â”‚
â”‚  â”‚ - Attempt 3: Failed                  â”‚               â”‚
â”‚  â”‚ â†’ Task FAILED (reported to user)     â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                                                         â”‚
â”‚ âœ… NO FALSE POSITIVES (graceful fallback fixed!)        â”‚
â”‚ âœ… Real error handling, not masking                     â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ĞŸÑ€Ğ°ĞºÑ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ Timeline

```
00:00  Task starts: "Open calculator, compute 333Ã—2=666"
       
00:01  Stage 1: Atlas decides what to do
       â”œâ”€ Task type: execution (not chat)
       â”œâ”€ Required servers: applescript, shell, playwright
       â””â”€ Sends to Stage 2
       
00:02  Stage 2.0: Pre-select servers
       â”œâ”€ Analysis: Need GUI automation + shell
       â”œâ”€ Selected: ["applescript", "shell", "playwright"]
       â””â”€ Pass to Tetyana
       
00:03  Stage 2.1: Tetyana PLANS
       â”œâ”€ Gets 40-tool list (not 92)
       â”œâ”€ LLM processes quickly
       â”œâ”€ Plans: Open app â†’ Take screenshot
       â””â”€ Returns tool_calls
       
00:04  Stage 2.2: Tetyana EXECUTES
       â”œâ”€ applescript_execute: Open Calculator
       â”‚  âœ… SUCCESS (0.5s)
       â”œâ”€ execute_command: screenshot
       â”‚  âœ… SUCCESS (0.3s)
       â””â”€ Total execution: 0.8s
       
00:05  Stage 2.3: Grisha VERIFIES
       â”œâ”€ Gets execution results
       â”œâ”€ Plans verification with 40 tools
       â”œâ”€ execute_command: Take verification screenshot
       â”‚  âœ… SUCCESS (0.3s)
       â””â”€ Screenshot file ready
       
00:06  Stage 3: Grisha ANALYZES
       â”œâ”€ LLM reads screenshot data
       â”œâ”€ Compares to "333Ã—2=666"
       â”œâ”€ Screenshot shows: "333Ã—333=333,333,333" âŒ
       â””â”€ verified: FALSE
       
00:07  Retry Logic Triggers
       â”œâ”€ Attempt 1: FAILED
       â”œâ”€ Back to Stage 2.0
       â”œâ”€ New plan: Clear, re-enter calculation
       â””â”€ Attempt 2 starts
       
       ... (similar flow) ...
       
00:15  After 3 attempts: Task FAILED
       â””â”€ Report to user: "Unable to get correct result"
       
```

---

**Ğ”Ğ¸Ğ°Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğ° Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ°:** 16 Ğ¾ĞºÑ‚ÑĞ±Ñ€Ñ 2025
**Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ:** âœ… Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ğ° Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ğ° Ğº Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
