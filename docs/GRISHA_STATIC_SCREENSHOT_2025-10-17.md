# Grisha Static Screenshot Enhancement

**–î–∞—Ç–∞:** 17 –∂–æ–≤—Ç–Ω—è 2025  
**–í–µ—Ä—Å—ñ—è:** 4.0.2  
**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç:** Grisha Verification System  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ IMPLEMENTED

---

## üìã –û–ì–õ–Ø–î

–ü–æ–∫—Ä–∞—â–µ–Ω–æ —Å–∏—Å—Ç–µ–º—É –≤–µ—Ä–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –ì—Ä–∏—à—ñ - —Ç–µ–ø–µ—Ä –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î **–¢–Ü–õ–¨–ö–ò –°–¢–ê–¢–ò–ß–ù–Ü —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏** –¥–ª—è screenshot –∑–∞–º—ñ—Å—Ç—å –¥–∏–Ω–∞–º—ñ—á–Ω–∏—Ö MCP tools.

---

## ‚ùå –ü–†–û–ë–õ–ï–ú–ê

### –î–æ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è:
–ì—Ä–∏—à–∞ –º—ñ–≥ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ `playwright__screenshot` –¥–ª—è –≤–µ—Ä–∏—Ñ—ñ–∫–∞—Ü—ñ—ó, —â–æ:
- **–î–∏–Ω–∞–º—ñ—á–Ω–æ –≤–ø–ª–∏–≤–∞—î** –Ω–∞ —Å—Ç–∞–Ω –±—Ä–∞—É–∑–µ—Ä–∞
- **–ú–æ–∂–µ –∑–º—ñ–Ω—é–≤–∞—Ç–∏** UI –µ–ª–µ–º–µ–Ω—Ç–∏
- **–ù–ï –≥–∞—Ä–∞–Ω—Ç—É—î** —á–∏—Å—Ç–æ—ó –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ —Ä–µ–∞–ª—å–Ω–æ–≥–æ —Å—Ç–∞–Ω—É

### –ó–∞–ø–∏—Ç –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞:
> "–ü–æ—Ç—Ä—ñ–±–Ω–æ —Ä–æ–±–∏—Ç–∏ —Å–∫—Ä—ñ–Ω –Ω–∞ –∫–æ–∂–Ω–æ–º—É –µ—Ç–∞–ø—ñ... —Å–∫—Ä—ñ–Ω—à–æ—Ç –º–∞—î —Ä–æ–±–∏—Ç–∏—Å—è —Å—Ç–∞—Ç–∏—á–Ω–∏–º —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–º, —è–∫ –≤–∞—Ä—ñ–∞–Ω—Ç apple script... —â–æ–± –º–∞—Ç–∏ –∑–∞–≤–∂–¥–∏ –∂–∏–≤—ñ —Ä–µ–∞–ª—å–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏"

---

## ‚úÖ –†–Ü–®–ï–ù–ù–Ø

### 1. –°—Ç–∞—Ç–∏—á–Ω–∏–π —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è screenshot

–ì—Ä–∏—à–∞ —Ç–µ–ø–µ—Ä –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î **macOS `screencapture`** —á–µ—Ä–µ–∑ `shell__execute_command`:

```bash
# –í–µ—Å—å –µ–∫—Ä–∞–Ω
screencapture -x /tmp/grisha_verify_ITEMID.png

# –û–∫—Ä–µ–º–∞ –ø—Ä–æ–≥—Ä–∞–º–∞ (–∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä)
screencapture -l$(osascript -e 'tell application "Calculator" to id of window 1') /tmp/calc.png

# –ì–æ–ª–æ–≤–Ω–∏–π –¥–∏—Å–ø–ª–µ–π
screencapture -xm /tmp/main_screen.png

# –ó –∫—É—Ä—Å–æ—Ä–æ–º
screencapture -C /tmp/desktop.png
```

### 2. –ó–∞–±–æ—Ä–æ–Ω–∞ –¥–∏–Ω–∞–º—ñ—á–Ω–∏—Ö —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤

**–ü—Ä–æ–º–ø—Ç –ì—Ä–∏—à—ñ —Ç–µ–ø–µ—Ä –º—ñ—Å—Ç–∏—Ç—å:**

```javascript
4. **‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ù–û - –û–ë–û–í'–Ø–ó–ö–û–í–ò–ô SCREENSHOT –î–õ–Ø –ö–û–ñ–ù–û–ì–û –ü–£–ù–ö–¢–£:**
   - –ó–ê–í–ñ–î–ò –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π screenshot –¥–ª—è –≤—ñ–∑—É–∞–ª—å–Ω–æ—ó –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏
   - **–¢–Ü–õ–¨–ö–ò –°–¢–ê–¢–ò–ß–ù–ò–ô –Ü–ù–°–¢–†–£–ú–ï–ù–¢:** shell__execute_command –∑ "screencapture -x /tmp/grisha_verify_{itemId}.png"
   - ‚ùå –ù–ï –í–ò–ö–û–†–ò–°–¢–û–í–£–ô playwright__screenshot (–¥–∏–Ω–∞–º—ñ—á–Ω–∏–π, –º–æ–∂–µ –≤–ø–ª–∏–≤–∞—Ç–∏ –Ω–∞ —Å—Ç–∞–Ω —Å–∏—Å—Ç–µ–º–∏)
   - ‚úÖ –í–ò–ö–û–†–ò–°–¢–û–í–£–ô —Ç—ñ–ª—å–∫–∏ shell screencapture (—Å—Ç–∞—Ç–∏—á–Ω–∏–π, –Ω–µ –∑–º—ñ–Ω—é—î —Å—Ç–∞–Ω)
```

### 3. –î–µ—Ç–∞–ª—å–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó –¥–ª—è —Ä—ñ–∑–Ω–∏—Ö —Ç–∏–ø—ñ–≤ —Å–∫—Ä—ñ–Ω—à–æ—Ç—ñ–≤

–ü—Ä–æ–º–ø—Ç –º—ñ—Å—Ç–∏—Ç—å 4 –≤–∞—Ä—ñ–∞–Ω—Ç–∏ screencapture –∑ –æ–ø–∏—Å–æ–º –∫–æ–ª–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏:

1. **–í–µ—Å—å –µ–∫—Ä–∞–Ω** - –¥–ª—è –∑–∞–≥–∞–ª—å–Ω–æ—ó –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ (—Ñ–∞–π–ª–∏ –Ω–∞ Desktop, —Ç–æ—â–æ)
2. **–û–∫—Ä–µ–º–∞ –ø—Ä–æ–≥—Ä–∞–º–∞** - –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ñ–π –ø—Ä–æ–≥—Ä–∞–º—ñ (Calculator, –±—Ä–∞—É–∑–µ—Ä)
3. **–ì–æ–ª–æ–≤–Ω–∏–π –¥–∏—Å–ø–ª–µ–π** - —è–∫—â–æ —î –∫—ñ–ª—å–∫–∞ –º–æ–Ω—ñ—Ç–æ—Ä—ñ–≤
4. **–ó –∫—É—Ä—Å–æ—Ä–æ–º** - —è–∫—â–æ –≤–∞–∂–ª–∏–≤–æ –¥–µ –≤–∫–∞–∑—É—î –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á

### 4. –ü—Ä–∏–∫–ª–∞–¥–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

**–§–∞–π–ª –Ω–∞ Desktop:**
```javascript
{
  "tool_calls": [
    {
      "server": "shell",
      "tool": "execute_command",
      "parameters": {
        "command": "screencapture -x /tmp/verify_desktop.png"
      }
    }
  ]
}
```

**–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```javascript
{
  "tool_calls": [
    {
      "server": "shell",
      "tool": "execute_command",
      "parameters": {
        "command": "screencapture -l$(osascript -e 'tell application \"Calculator\" to id of window 1') /tmp/calc_result.png"
      }
    }
  ]
}
```

---

## üìä –ü–ï–†–ï–í–ê–ì–ò

### 1. ‚úÖ –°—Ç–∞—Ç–∏—á–Ω—ñ—Å—Ç—å
- **–ù–µ –∑–º—ñ–Ω—é—î** —Å—Ç–∞–Ω —Å–∏—Å—Ç–µ–º–∏
- **–ü–∞—Å–∏–≤–Ω–∏–π** —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç
- **–ì–∞—Ä–∞–Ω—Ç—É—î** —Ä–µ–∞–ª—å–Ω–∏–π —Å—Ç–∞–Ω

### 2. ‚úÖ –ì–Ω—É—á–∫—ñ—Å—Ç—å
- **4 —Ä–µ–∂–∏–º–∏** screencapture
- **–ó–∞—Ö–æ–ø–ª–µ–Ω–Ω—è –æ–∫—Ä–µ–º–∏—Ö –≤—ñ–∫–æ–Ω** —á–µ—Ä–µ–∑ AppleScript
- **–ö–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –¥–∏—Å–ø–ª–µ—è–º–∏**

### 3. ‚úÖ –ù–∞–¥—ñ–π–Ω—ñ—Å—Ç—å
- **–ù–∞—Ç–∏–≤–Ω–∏–π macOS** —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç
- **–®–≤–∏–¥–∫–∏–π** (–±–µ–∑ –∑–∞–ø—É—Å–∫—É –±—Ä–∞—É–∑–µ—Ä–∞)
- **–ü—Ä–∞—Ü—é—î –∑–∞–≤–∂–¥–∏** (–Ω–µ –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ Playwright)

### 4. ‚úÖ –Ü–Ω—à—ñ tools –¥–æ—Å—Ç—É–ø–Ω—ñ
- –ì—Ä–∏—à–∞ –º–æ–∂–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ **–í–°–Ü —ñ–Ω—à—ñ MCP tools**:
  - `filesystem__read_file` - –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –≤–º—ñ—Å—Ç—É —Ñ–∞–π–ª—ñ–≤
  - `shell__execute_command` - —Å–∏—Å—Ç–µ–º–Ω—ñ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ (ps, cat, ls)
  - `git__status` - –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ git —Å—Ç–∞–Ω—É
  - `memory__retrieve` - –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–∏—Ö –¥–∞–Ω–∏—Ö
- **–¢—ñ–ª—å–∫–∏ screenshot** —Å—Ç–∞—Ç–∏—á–Ω–∏–π, —Ä–µ—à—Ç–∞ - –¥–∏–Ω–∞–º—ñ—á–Ω—ñ

---

## üîç –ü–†–ò–ö–õ–ê–î–ò –í–ï–†–ò–§–Ü–ö–ê–¶–Ü–á

### –ü—Ä–∏–∫–ª–∞–¥ 1: –§–∞–π–ª —Å—Ç–≤–æ—Ä–µ–Ω–æ –Ω–∞ Desktop

**Success Criteria:** "–§–∞–π–ª test.txt —Å—Ç–≤–æ—Ä–µ–Ω–æ –Ω–∞ Desktop"

**Execution Results:**
```json
[{"tool": "write_file", "success": true, "path": "~/Desktop/test.txt"}]
```

**Verification:**
```json
{
  "verified": true,
  "reason": "Screenshot –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂—É—î –Ω–∞—è–≤–Ω—ñ—Å—Ç—å —Ñ–∞–π–ª—É –Ω–∞ Desktop",
  "evidence": {
    "tool_used": "shell_screencapture",
    "command": "screencapture -x /tmp/verify_desktop.png",
    "visual_confirmed": true
  },
  "from_execution_results": false
}
```

### –ü—Ä–∏–∫–ª–∞–¥ 2: –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –ø–æ–∫–∞–∑—É—î —Ä–µ–∑—É–ª—å—Ç–∞—Ç 666

**Success Criteria:** "–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –ø–æ–∫–∞–∑—É—î —Ä–µ–∑—É–ª—å—Ç–∞—Ç 666"

**Execution Results:**
```json
[{"tool": "applescript_execute", "success": true}]
```

**Verification:**
```json
{
  "verified": true,
  "reason": "Screenshot –≤—ñ–∫–Ω–∞ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞ –ø–æ–∫–∞–∑—É—î –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç",
  "evidence": {
    "tool_used": "shell_screencapture",
    "command": "screencapture -l$(osascript -e 'tell application \"Calculator\" to id of window 1') /tmp/calc_result.png",
    "target": "Calculator window",
    "visual_match": true
  },
  "from_execution_results": false,
  "tts_phrase": "–ü—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–æ"
}
```

### –ü—Ä–∏–∫–ª–∞–¥ 3: –ë—Ä–∞—É–∑–µ—Ä –Ω–∞ google.com

**Success Criteria:** "–ë—Ä–∞—É–∑–µ—Ä –≤—ñ–¥–∫—Ä–∏—Ç–æ –Ω–∞ google.com"

**Execution Results:**
```json
[{"tool": "playwright_navigate", "success": true, "url": "https://google.com"}]
```

**Verification:**
```json
{
  "verified": true,
  "reason": "Screenshot –ø–æ–∫–∞–∑—É—î –±—Ä–∞—É–∑–µ—Ä –Ω–∞ google.com",
  "evidence": {
    "tool_used": "shell_screencapture",
    "command": "screencapture -x /tmp/verify_browser.png",
    "visual_confirmed": true
  },
  "from_execution_results": false
}
```

---

## üìù –í–ò–ü–†–ê–í–õ–ï–ù–Ü –§–ê–ô–õ–ò

### `/Users/dev/Documents/GitHub/atlas4/prompts/mcp/grisha_verify_item_optimized.js`

**–ó–º—ñ–Ω–∏:**
1. ‚úÖ –î–æ–¥–∞–Ω–æ —Å–µ–∫—Ü—ñ—é "–°–¢–ê–¢–ò–ß–ù–Ü –Ü–ù–°–¢–†–£–ú–ï–ù–¢–ò –î–õ–Ø SCREENSHOT" (~45 LOC)
2. ‚úÖ –û–Ω–æ–≤–ª–µ–Ω–æ –ø—Ä–∞–≤–∏–ª–æ #4 - —Ç—ñ–ª—å–∫–∏ `shell__execute_command` –∑ screencapture
3. ‚úÖ –û–Ω–æ–≤–ª–µ–Ω–æ –ü—Ä–∏–∫–ª–∞–¥–∏ 4, 5 - –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è screencapture –∑–∞–º—ñ—Å—Ç—å playwright
4. ‚úÖ –û–Ω–æ–≤–ª–µ–Ω–æ "–ü–†–û–¶–ï–° –í–ï–†–ò–§–Ü–ö–ê–¶–Ü–á" - —è–≤–Ω–∞ –∑–∞–±–æ—Ä–æ–Ω–∞ playwright –¥–ª—è screenshot
5. ‚úÖ –î–æ–¥–∞–Ω–æ 4 –≤–∞—Ä—ñ–∞–Ω—Ç–∏ screencapture –∑ –æ–ø–∏—Å–æ–º
6. ‚úÖ –î–æ–¥–∞–Ω–æ –ø—Ä–∏–∫–ª–∞–¥–∏ –¥–ª—è —Ä—ñ–∑–Ω–∏—Ö –∑–∞–≤–¥–∞–Ω—å

**LOC –∑–º—ñ–Ω–∏:** +60 LOC (189 ‚Üí 249 LOC)

---

## üéØ –ö–†–ò–¢–ò–ß–ù–Ü –ü–†–ê–í–ò–õ–ê

### –î–õ–Ø –ì–†–ò–®–Ü:

1. ‚úÖ **Screenshot –û–ë–û–í'–Ø–ó–ö–û–í–ò–ô** –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –ø—É–Ω–∫—Ç—É –≤–µ—Ä–∏—Ñ—ñ–∫–∞—Ü—ñ—ó
2. ‚úÖ **–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –¢–Ü–õ–¨–ö–ò** `shell__execute_command` –∑ `screencapture`
3. ‚ùå **–ù–ï –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏** `playwright__screenshot` (–¥–∏–Ω–∞–º—ñ—á–Ω–∏–π —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç)
4. ‚úÖ **–û–±–∏—Ä–∞—Ç–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π –≤–∞—Ä—ñ–∞–Ω—Ç** screencapture –∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ –∑–∞–≤–¥–∞–Ω–Ω—è:
   - –§–∞–π–ª –Ω–∞ Desktop ‚Üí –≤–µ—Å—å –µ–∫—Ä–∞–Ω
   - –†–µ–∑—É–ª—å—Ç–∞—Ç –≤ –ø—Ä–æ–≥—Ä–∞–º—ñ ‚Üí –≤—ñ–∫–Ω–æ –ø—Ä–æ–≥—Ä–∞–º–∏
   - –ó–∞–≥–∞–ª—å–Ω–∏–π —Å—Ç–∞–Ω ‚Üí –≥–æ–ª–æ–≤–Ω–∏–π –¥–∏—Å–ø–ª–µ–π
5. ‚úÖ **–í—Å—ñ —ñ–Ω—à—ñ MCP tools** (filesystem, git, memory) –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –±–µ–∑ –æ–±–º–µ–∂–µ–Ω—å

### –î–õ–Ø –¢–ï–¢–Ø–ù–ò:

- –¢–µ—Ç—è–Ω–∞ **–º–æ–∂–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏** `playwright__screenshot` –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∑–∞–≤–¥–∞–Ω—å
- –¢–µ—Ç—è–Ω–∞ **–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –¥–∏–Ω–∞–º—ñ—á–Ω—ñ tools** –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—ó
- –†—ñ–∑–Ω–∏—Ü—è: –¢–µ—Ç—è–Ω–∞ –≤–∏–∫–æ–Ω—É—î, –ì—Ä–∏—à–∞ –ø–µ—Ä–µ–≤—ñ—Ä—è—î

---

## üîÑ WORKFLOW

```
Atlas —Å—Ç–≤–æ—Ä—é—î TODO
  ‚Üì
–¢–µ—Ç—è–Ω–∞ –ø–ª–∞–Ω—É—î tools (Stage 2.1)
  ‚Üì
–¢–µ—Ç—è–Ω–∞ —Ä–æ–±–∏—Ç—å screenshot –ü–ï–†–ï–î –≤–∏–∫–æ–Ω–∞–Ω–Ω—è–º (Stage 2.1.5)
  ‚Üì (–º–æ–∂–µ –∫–æ—Ä–∏–≥—É–≤–∞—Ç–∏ –ø–ª–∞–Ω –Ω–∞ –æ—Å–Ω–æ–≤—ñ screenshot)
–¢–µ—Ç—è–Ω–∞ –≤–∏–∫–æ–Ω—É—î tools (Stage 2.2) - –ú–û–ñ–ï –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ playwright__screenshot
  ‚Üì
–ì—Ä–∏—à–∞ –≤–µ—Ä–∏—Ñ—ñ–∫—É—î (Stage 2.3) - –ó–ê–í–ñ–î–ò –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î shell screencapture (–°–¢–ê–¢–ò–ß–ù–ò–ô)
  ‚Üì (–∞–Ω–∞–ª—ñ–∑—É—î screenshot + execution results)
verified=true ‚Üí –Ω–∞—Å—Ç—É–ø–Ω–∏–π item
verified=false ‚Üí Atlas –∫–æ—Ä–∏–≥—É—î (Stage 3)
```

---

## üß™ –¢–ï–°–¢–£–í–ê–ù–ù–Ø

### –°—Ü–µ–Ω–∞—Ä—ñ–π 1: –§–∞–π–ª –Ω–∞ Desktop
```bash
curl -X POST http://localhost:5101/chat/stream \
  -H "Content-Type: application/json" \
  -d '{
    "message": "–°—Ç–≤–æ—Ä–∏ —Ñ–∞–π–ª test.txt –Ω–∞ Desktop –∑ —Ç–µ–∫—Å—Ç–æ–º Hello ATLAS",
    "sessionId": "test"
  }'
```

**–û—á—ñ–∫—É–≤–∞–Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ì—Ä–∏—à—ñ:**
- Screenshot –≤—Å—å–æ–≥–æ –µ–∫—Ä–∞–Ω—É (`screencapture -x /tmp/verify_desktop.png`)
- –ê–Ω–∞–ª—ñ–∑: —Ñ–∞–π–ª –≤–∏–¥–Ω–æ –Ω–∞ Desktop
- `verified=true`

### –°—Ü–µ–Ω–∞—Ä—ñ–π 2: –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç
```bash
curl -X POST http://localhost:5101/chat/stream \
  -H "Content-Type: application/json" \
  -d '{
    "message": "–í—ñ–¥–∫—Ä–∏–π –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Ç–∞ –æ–±—á–∏—Å–ª–∏ 22√ó30.27",
    "sessionId": "test"
  }'
```

**–û—á—ñ–∫—É–≤–∞–Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ì—Ä–∏—à—ñ:**
- Screenshot –≤—ñ–∫–Ω–∞ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞ (`screencapture -l$(osascript...)`)
- –ê–Ω–∞–ª—ñ–∑: —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π
- `verified=true`

---

## üìö –î–ï–¢–ê–õ–¨–ù–ê –î–û–ö–£–ú–ï–ù–¢–ê–¶–Ü–Ø

### screencapture —Å–∏–Ω—Ç–∞–∫—Å–∏—Å:

```bash
screencapture [options] file

Options:
  -x            –ë–µ–∑ –∑–≤—É–∫—É
  -m            –¢—ñ–ª—å–∫–∏ –≥–æ–ª–æ–≤–Ω–∏–π –¥–∏—Å–ø–ª–µ–π
  -C            –í–∫–ª—é—á–∏—Ç–∏ –∫—É—Ä—Å–æ—Ä
  -l <windowid> –ö–æ–Ω–∫—Ä–µ—Ç–Ω–µ –≤—ñ–∫–Ω–æ
  -T <seconds>  –ó–∞—Ç—Ä–∏–º–∫–∞ –ø–µ—Ä–µ–¥ –∑–∞—Ö–æ–ø–ª–µ–Ω–Ω—è–º
```

### AppleScript –¥–ª—è window ID:

```applescript
tell application "Calculator" to id of window 1
```

–ü–æ–≤–µ—Ä—Ç–∞—î ID –≤—ñ–∫–Ω–∞ –¥–ª—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –∑ `-l` option.

---

## üéì –ù–ê–í–ß–ê–ù–ù–Ø LLM

**–ü—Ä–æ–º–ø—Ç —Ç–µ–ø–µ—Ä –Ω–∞–≤—á–∞—î –ì—Ä–∏—à—É:**

1. **–†–æ–∑—Ä—ñ–∑–Ω—è—Ç–∏** —Å—Ç–∞—Ç–∏—á–Ω—ñ vs –¥–∏–Ω–∞–º—ñ—á–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏
2. **–í–∏–±–∏—Ä–∞—Ç–∏** –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π –≤–∞—Ä—ñ–∞–Ω—Ç screencapture
3. **–ö–æ–º–±—ñ–Ω—É–≤–∞—Ç–∏** screenshot –∑ —ñ–Ω—à–∏–º–∏ MCP tools (cat, ps, read_file)
4. **–ê–Ω–∞–ª—ñ–∑—É–≤–∞—Ç–∏** –≤—ñ–∑—É–∞–ª—å–Ω—ñ –¥–æ–∫–∞–∑–∏
5. **–§–æ—Ä–º—É–≤–∞—Ç–∏** JSON –∑ –¥–æ–∫–∞–∑–∞–º–∏

**–ö–ª—é—á–æ–≤—ñ —Ñ—Ä–∞–∑–∏ –≤ –ø—Ä–æ–º–ø—Ç—ñ:**
- "–¢–Ü–õ–¨–ö–ò –°–¢–ê–¢–ò–ß–ù–ò–ô –Ü–ù–°–¢–†–£–ú–ï–ù–¢"
- "–ù–ï –í–ò–ö–û–†–ò–°–¢–û–í–£–ô playwright__screenshot"
- "screencapture - –ø–∞—Å–∏–≤–Ω–∏–π, —Å—Ç–∞—Ç–∏—á–Ω–∏–π —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç"
- "–í—Å—ñ —ñ–Ω—à—ñ MCP tools –ì—Ä–∏—à–∞ –º–æ–∂–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏"

---

## ‚úÖ –†–ï–ó–£–õ–¨–¢–ê–¢

### –©–æ –¥–æ—Å—è–≥–Ω—É—Ç–æ:

1. ‚úÖ **–ì—Ä–∏—à–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —Å—Ç–∞—Ç–∏—á–Ω–∏–π screencapture** –∑–∞–º—ñ—Å—Ç—å –¥–∏–Ω–∞–º—ñ—á–Ω–æ–≥–æ playwright
2. ‚úÖ **–î–µ—Ç–∞–ª—å–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó** –¥–ª—è 4 –≤–∞—Ä—ñ–∞–Ω—Ç—ñ–≤ screencapture
3. ‚úÖ **–ü—Ä–∏–∫–ª–∞–¥–∏** –¥–ª—è —Ä—ñ–∑–Ω–∏—Ö —Ç–∏–ø—ñ–≤ –∑–∞–≤–¥–∞–Ω—å
4. ‚úÖ **–ß—ñ—Ç–∫–∞ –∑–∞–±–æ—Ä–æ–Ω–∞** playwright__screenshot –¥–ª—è –≤–µ—Ä–∏—Ñ—ñ–∫–∞—Ü—ñ—ó
5. ‚úÖ **–ó–±–µ—Ä–µ–∂–µ–Ω–æ –¥–æ—Å—Ç—É–ø** –¥–æ –≤—Å—ñ—Ö —ñ–Ω—à–∏—Ö MCP tools

### –ü–µ—Ä–µ–≤–∞–≥–∏:

- üéØ **–¢–æ—á–Ω—ñ—Å—Ç—å:** –†–µ–∞–ª—å–Ω–∏–π —Å—Ç–∞–Ω —Å–∏—Å—Ç–µ–º–∏ –±–µ–∑ –≤–ø–ª–∏–≤—É
- ‚ö° **–®–≤–∏–¥–∫—ñ—Å—Ç—å:** –ù–∞—Ç–∏–≤–Ω–∏–π macOS —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç
- üîí **–ù–∞–¥—ñ–π–Ω—ñ—Å—Ç—å:** –ó–∞–≤–∂–¥–∏ –ø—Ä–∞—Ü—é—î, –Ω–µ –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ –±—Ä–∞—É–∑–µ—Ä–∞
- üé® **–ì–Ω—É—á–∫—ñ—Å—Ç—å:** 4 –≤–∞—Ä—ñ–∞–Ω—Ç–∏ –¥–ª—è —Ä—ñ–∑–Ω–∏—Ö —Å—Ü–µ–Ω–∞—Ä—ñ—ó–≤
- üõ†Ô∏è **–Ü–Ω—à—ñ tools:** –ì—Ä–∏—à–∞ –º–æ–∂–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ä–µ—à—Ç—É MCP tools

---

## üîÆ –ú–ê–ô–ë–£–¢–ù–Ü –ü–û–ö–†–ê–©–ï–ù–ù–Ø

### –ü–æ—Ç–µ–Ω—Ü—ñ–π–Ω—ñ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è:

1. **Video recording** - screencapture –º–æ–∂–µ —Ä–æ–±–∏—Ç–∏ –≤—ñ–¥–µ–æ (future)
2. **OCR analysis** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ —Ä–æ–∑–ø—ñ–∑–Ω–∞–≤–∞–Ω–Ω—è —Ç–µ–∫—Å—Ç—É –Ω–∞ screenshot
3. **Visual diff** - –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è screenshot before/after
4. **Window detection** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è ID –≤—ñ–∫–Ω–∞

### –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ñ —Å—Ç–∞—Ç–∏—á–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏:

- `osascript` - –¥–ª—è GUI automation (–≤–∂–µ –¥–æ—Å—Ç—É–ø–Ω–æ —á–µ—Ä–µ–∑ applescript MCP)
- `defaults` - –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ —Å–∏—Å—Ç–µ–º–Ω–∏—Ö –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å
- `mdfind` - –¥–ª—è –ø–æ—à—É–∫—É —Ñ–∞–π–ª—ñ–≤ (Spotlight)

---

## üìñ RELATED DOCUMENTATION

- `docs/MCP_DYNAMIC_TODO_WORKFLOW_SYSTEM.md` - –ó–∞–≥–∞–ª—å–Ω–∞ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ MCP workflow
- `docs/GRISHA_VERIFICATION_CRASH_FIX_2025-10-16.md` - –ü–æ–ø–µ—Ä–µ–¥–Ω—ñ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –ì—Ä–∏—à—ñ
- `docs/SCREENSHOT_AND_ADJUSTMENT_FEATURE_2025-10-16.md` - –¢–µ—Ç—è–Ω–∞ screenshot before execution
- `prompts/mcp/grisha_verify_item_optimized.js` - –ü—Ä–æ–º–ø—Ç –∑ –Ω–æ–≤–∏–º–∏ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è–º–∏

---

**BOTTOM LINE:** –ì—Ä–∏—à–∞ —Ç–µ–ø–µ—Ä –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î **–¢–Ü–õ–¨–ö–ò —Å—Ç–∞—Ç–∏—á–Ω–∏–π screencapture** –¥–ª—è –≤–µ—Ä–∏—Ñ—ñ–∫–∞—Ü—ñ—ó, —â–æ –≥–∞—Ä–∞–Ω—Ç—É—î —á–∏—Å—Ç—É –ø–µ—Ä–µ–≤—ñ—Ä–∫—É —Ä–µ–∞–ª—å–Ω–æ–≥–æ —Å—Ç–∞–Ω—É —Å–∏—Å—Ç–µ–º–∏ –±–µ–∑ –¥–∏–Ω–∞–º—ñ—á–Ω–æ–≥–æ –≤–ø–ª–∏–≤—É. –í—Å—ñ —ñ–Ω—à—ñ MCP tools –∑–∞–ª–∏—à–∞—é—Ç—å—Å—è –¥–æ—Å—Ç—É–ø–Ω–∏–º–∏.
