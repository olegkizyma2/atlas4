# TODO-WEB-001: Voice-Control Consolidation - –ê–ù–ê–õ–Ü–ó –°–ò–°–¢–ï–ú–ò

**–î–∞—Ç–∞:** 11 –∂–æ–≤—Ç–Ω—è 2025, ~21:50  
**–°—Ç–∞—Ç—É—Å:** üìä –ê–ù–ê–õ–Ü–ó  
**–ü—Ä—ñ–æ—Ä–∏—Ç–µ—Ç:** üî¥ –ö—Ä–∏—Ç–∏—á–Ω–∏–π  

---

## üìä –ü–æ—Ç–æ—á–Ω–∏–π –°—Ç–∞–Ω Voice-Control –°–∏—Å—Ç–µ–º–∏

### –ó–∞–≥–∞–ª—å–Ω—ñ –ú–µ—Ç—Ä–∏–∫–∏:
- **–§–∞–π–ª—ñ–≤:** 38 JavaScript —Ñ–∞–π–ª—ñ–≤
- **–†—è–¥–∫—ñ–≤ –∫–æ–¥—É:** 19,070 LOC
- **–ü–∞–ø–æ–∫:** 13 –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ–π
- **–°—Ç—Ä—É–∫—Ç—É—Ä–∞:** –ú–æ–¥—É–ª—å–Ω–∞ –∑ DI Container

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ü–∞–ø–æ–∫:
```
web/static/js/voice-control/
‚îú‚îÄ‚îÄ core/                    # 7 —Ñ–∞–π–ª—ñ–≤ - Base services, VAD, monitors
‚îú‚îÄ‚îÄ services/               # 7 —Ñ–∞–π–ª—ñ–≤ - TTS, STT, keyword, microphone
‚îú‚îÄ‚îÄ conversation/           # 5+ —Ñ–∞–π–ª—ñ–≤ - Conversation mode logic
‚îú‚îÄ‚îÄ modules/               # 3 —Ñ–∞–π–ª–∏ - Managers (service, event, status)
‚îú‚îÄ‚îÄ monitoring/            # 1 —Ñ–∞–π–ª - Performance monitoring
‚îú‚îÄ‚îÄ events/                # 1 —Ñ–∞–π–ª - Event system
‚îú‚îÄ‚îÄ utils/                 # 1 —Ñ–∞–π–ª - Utility functions
‚îú‚îÄ‚îÄ types/                 # 1 —Ñ–∞–π–ª - TypeScript types
‚îú‚îÄ‚îÄ managers/              # –ü–£–°–¢–ê –ø–∞–ø–∫–∞ ‚ùå
‚îú‚îÄ‚îÄ tests/                 # Test files
‚îî‚îÄ‚îÄ ROOT files:            # 6 —Ñ–∞–π–ª—ñ–≤ (–≤–∫–ª—é—á–∞—é—á–∏ legacy)
    ‚îú‚îÄ‚îÄ voice-control-manager.js       (31K, 953 LOC) ‚úÖ –ê–ö–¢–ò–í–ù–ò–ô
    ‚îú‚îÄ‚îÄ conversation-mode-manager.js   (25K, 803 LOC) ‚úÖ –ê–ö–¢–ò–í–ù–ò–ô
    ‚îú‚îÄ‚îÄ atlas-voice-integration.js     (–∞–∫—Ç–∏–≤–Ω–∏–π)
    ‚îú‚îÄ‚îÄ voice-control-manager-v4.js    (13K) ‚ùå LEGACY/UNUSED
    ‚îú‚îÄ‚îÄ conversation-mode-manager-v4.js (10K) ‚ùå LEGACY/UNUSED
    ‚îî‚îÄ‚îÄ atlas-voice-system-v2.js       (??) ü§î –ü–ï–†–ï–í–Ü–†–ò–¢–ò
```

---

## üîç –í–∏—è–≤–ª–µ–Ω—ñ –ü—Ä–æ–±–ª–µ–º–∏

### 1. üî¥ Legacy/Unused Files (–ö–†–ò–¢–ò–ß–ù–û)
**–§–∞–π–ª–∏ —è–∫—ñ –ù–ï –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è:**
- `voice-control-manager-v4.js` (13K) - –ù–ï —ñ–º–ø–æ—Ä—Ç—É—î—Ç—å—Å—è –Ω—ñ–¥–µ
- `conversation-mode-manager-v4.js` (10K) - –ù–ï —ñ–º–ø–æ—Ä—Ç—É—î—Ç—å—Å—è –Ω—ñ–¥–µ
- `atlas-voice-system-v2.js` (??) - –ü–æ—Ç—Ä–µ–±—É—î –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏

**–ü—Ä–æ–±–ª–µ–º–∞:** 23K+ legacy –∫–æ–¥—É –∑–∞—Å–º—ñ—á—É—î —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è:** –í–ò–î–ê–õ–ò–¢–ò –ø—ñ—Å–ª—è –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è

---

### 2. üü° –ü—É—Å—Ç–∞ –ü–∞–ø–∫–∞ (–°–ï–†–ï–î–ù–¨–û)
**–ü–∞–ø–∫–∞:** `managers/` - –ü–£–°–¢–ê

**–ü—Ä–æ–±–ª–µ–º–∞:** –°—Ç–≤–æ—Ä—é—î –ø–ª—É—Ç–∞–Ω–∏–Ω—É –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä—ñ

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è:** –í–ò–î–ê–õ–ò–¢–ò –∞–±–æ –ø–µ—Ä–µ–º—ñ—Å—Ç–∏—Ç–∏ —Ñ–∞–π–ª–∏ –∑ `modules/` —è–∫—â–æ –ª–æ–≥—ñ—á–Ω–æ –ø—ñ–¥—Ö–æ–¥—è—Ç—å

---

### 3. üü¢ –î—É–±–ª—é–≤–∞–Ω–Ω—è –õ–æ–≥—ñ–∫–∏ (–ù–ò–ó–¨–ö–û)
**–ü—ñ–¥–æ–∑—Ä—ñ–ª—ñ –ø–∞–ø–∫–∏:**
- `conversation/` (5+ —Ñ–∞–π–ª—ñ–≤) vs `conversation-mode-manager.js` (25K)
- `modules/` (managers) vs –º–æ–∂–ª–∏–≤–∞ –¥—É–±–ª—ñ–∫–∞—Ü—ñ—è

**–ü–æ—Ç—Ä–µ–±—É—î:** –î–µ—Ç–∞–ª—å–Ω–∏–π –∞–Ω–∞–ª—ñ–∑ —á–∏ —î –¥—É–±–ª—é–≤–∞–Ω–Ω—è –º—ñ–∂ –ø–∞–ø–∫–æ—é —Ç–∞ —Ñ–∞–π–ª–æ–º

---

### 4. üü° –í–µ–ª–∏–∫—ñ –§–∞–π–ª–∏ (–°–ï–†–ï–î–ù–¨–û)
**–§–∞–π–ª–∏ –ø–æ–Ω–∞–¥ 20K:**
1. `voice-control-manager.js` - **31K (953 LOC)** ‚ö†Ô∏è
2. `conversation-mode-manager.js` - **25K (803 LOC)** ‚ö†Ô∏è

**–ü—Ä–æ–±–ª–µ–º–∞:** –°–∫–ª–∞–¥–Ω–æ –ø—ñ–¥—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –º–æ–Ω–æ–ª—ñ—Ç–Ω—ñ —Ñ–∞–π–ª–∏

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è:** –†–æ–∑–±–∏—Ç–∏ –Ω–∞ –º–æ–¥—É–ª—ñ —è–∫—â–æ —î –ª–æ–≥—ñ—á–Ω—ñ –±–ª–æ–∫–∏

---

## üéØ –ü–ª–∞–Ω –ö–æ–Ω—Å–æ–ª—ñ–¥–∞—Ü—ñ—ó

### –§–∞–∑–∞ 1: Cleanup Legacy (–®–í–ò–î–ö–û - 5 —Ö–≤)
- [ ] –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —â–æ v4 —Ñ–∞–π–ª–∏ –ù–ï –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è
- [ ] –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ atlas-voice-system-v2.js
- [ ] –í–ò–î–ê–õ–ò–¢–ò legacy —Ñ–∞–π–ª–∏ (23K+ –∫–æ–¥—É)
- [ ] –í–ò–î–ê–õ–ò–¢–ò –ø—É—Å—Ç—É –ø–∞–ø–∫—É `managers/`

**Expected:** -23K LOC, -3 —Ñ–∞–π–ª–∏

---

### –§–∞–∑–∞ 2: –ê–Ω–∞–ª—ñ–∑ –î—É–±–ª—é–≤–∞–Ω–Ω—è (–°–ï–†–ï–î–ù–¨–û - 15 —Ö–≤)
- [ ] –ü–æ—Ä—ñ–≤–Ω—è—Ç–∏ `conversation/` –∑ `conversation-mode-manager.js`
- [ ] –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —á–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –≤—Å—è –ª–æ–≥—ñ–∫–∞ –∑ –ø–∞–ø–∫–∏
- [ ] –í–∏–∑–Ω–∞—á–∏—Ç–∏ —á–∏ –º–æ–∂–Ω–∞ –æ–±'—î–¥–Ω–∞—Ç–∏ –±–µ–∑ –≤—Ç—Ä–∞—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—ñ

**Expected:** –†–æ–∑—É–º—ñ–Ω–Ω—è –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∏

---

### –§–∞–∑–∞ 3: –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –í–µ–ª–∏–∫–∏—Ö –§–∞–π–ª—ñ–≤ (–û–ü–¶–Ü–û–ù–ê–õ–¨–ù–û - 30+ —Ö–≤)
**–¶–ï –û–ü–¶–Ü–û–ù–ê–õ–¨–ù–û!** –¢—ñ–ª—å–∫–∏ —è–∫—â–æ —î —á–∞—Å —ñ –±–∞–∂–∞–Ω–Ω—è.

- [ ] voice-control-manager.js (953 LOC) ‚Üí –º–æ–¥—É–ª—ñ?
- [ ] conversation-mode-manager.js (803 LOC) ‚Üí –º–æ–¥—É–ª—ñ?

**–†–∏–∑–∏–∫:** –ú–æ–∂–µ –ø–æ—Ä—É—à–∏—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å

**Expected:** –ö—Ä–∞—â–∏–π maintainability

---

### –§–∞–∑–∞ 4: –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è (–û–ë–û–í'–Ø–ó–ö–û–í–û - 10 —Ö–≤)
- [ ] –ó–∞–ø—É—Å—Ç–∏—Ç–∏ —Å–∏—Å—Ç–µ–º—É
- [ ] –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ voice control —Ñ—É–Ω–∫—Ü—ñ—ó:
  - [ ] Keyword detection ("–ê—Ç–ª–∞—Å")
  - [ ] Quick-send mode (–∫–ª—ñ–∫)
  - [ ] Conversation mode (—É—Ç—Ä–∏–º–∞–Ω–Ω—è 2—Å)
  - [ ] TTS playback
  - [ ] Microphone permissions
- [ ] –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —â–æ –ù–ï –∑–ª–∞–º–∞–Ω–æ –ø—ñ—Å–ª—è cleanup

---

## üìÅ –î–µ—Ç–∞–ª—å–Ω–∏–π –ê–Ω–∞–ª—ñ–∑ –Ü–º–ø–æ—Ä—Ç—ñ–≤

### –ê–∫—Ç–∏–≤–Ω–æ –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è:

#### app-refactored.js —ñ–º–ø–æ—Ä—Ç—É—î:
```javascript
import { ConversationModeManager } from './voice-control/conversation-mode-manager.js';
```

**–ü–æ—Ç—Ä–µ–±—É—î –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏:** –Ø–∫—ñ —ñ–Ω—à—ñ —Ñ–∞–π–ª–∏ —ñ–º–ø–æ—Ä—Ç—É—é—Ç—å voice-control –º–æ–¥—É–ª—ñ?

---

## üöÄ –†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–∏–π –ü–ª–∞–Ω –î—ñ–π

### –ú—ñ–Ω—ñ–º–∞–ª—å–Ω–∏–π –ü–ª–∞–Ω (SAFE - 20 —Ö–≤):
1. ‚úÖ –í–∏–¥–∞–ª–∏—Ç–∏ legacy v4 —Ñ–∞–π–ª–∏ (–ø—ñ—Å–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏)
2. ‚úÖ –í–∏–¥–∞–ª–∏—Ç–∏ –ø—É—Å—Ç—É –ø–∞–ø–∫—É managers/
3. ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç—É–≤–∞—Ç–∏ —â–æ –≤—Å–µ –ø—Ä–∞—Ü—é—î
4. ‚úÖ –û–Ω–æ–≤–∏—Ç–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—é

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** -23K LOC, —á–∏—Å—Ç—ñ—à–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞, –ë–ï–ó —Ä–∏–∑–∏–∫—É

---

### –ü–æ–≤–Ω–∏–π –ü–ª–∞–Ω (AGGRESSIVE - 1+ –≥–æ–¥):
1. ‚úÖ –ú—ñ–Ω—ñ–º–∞–ª—å–Ω–∏–π –ø–ª–∞–Ω
2. ‚è≥ –ê–Ω–∞–ª—ñ–∑ –¥—É–±–ª—é–≤–∞–Ω–Ω—è conversation/
3. ‚è≥ –ú–æ–∂–ª–∏–≤–µ –æ–±'—î–¥–Ω–∞–Ω–Ω—è –º–æ–¥—É–ª—ñ–≤
4. ‚è≥ –†–æ–∑–±–∏—Ç—Ç—è –≤–µ–ª–∏–∫–∏—Ö —Ñ–∞–π–ª—ñ–≤ (—è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ)
5. ‚úÖ –ü–æ–≤–Ω–µ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** -30%+ LOC, –æ–ø—Ç–∏–º–∞–ª—å–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞, –í–ò–°–û–ö–ò–ô —Ä–∏–∑–∏–∫

---

## ‚ö†Ô∏è –†–∏–∑–∏–∫–∏

### –í–∏—Å–æ–∫—ñ –†–∏–∑–∏–∫–∏:
1. **Breaking Changes** - –≤–∏–¥–∞–ª–µ–Ω–Ω—è "–Ω–µ–∞–∫—Ç–∏–≤–Ω–∏—Ö" —Ñ–∞–π–ª—ñ–≤ –º–æ–∂–µ –∑–ª–∞–º–∞—Ç–∏ –¥–∏–Ω–∞–º—ñ—á–Ω—ñ —ñ–º–ø–æ—Ä—Ç–∏
2. **Lost Functionality** - –º–æ–∂–ª–∏–≤–∞ –≤—Ç—Ä–∞—Ç–∞ —Ñ—ñ—á —è–∫—â–æ –≤–∏–¥–∞–ª–∏—Ç–∏ –≤–∞–∂–ª–∏–≤—ñ –º–æ–¥—É–ª—ñ
3. **Test Coverage** - –Ω–µ–º–∞—î –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏—Ö —Ç–µ—Å—Ç—ñ–≤ –¥–ª—è voice control

### –ú—ñ—Ç—ñ–≥–∞—Ü—ñ—è:
- ‚úÖ Grep search –ø–µ—Ä–µ–¥ –≤–∏–¥–∞–ª–µ–Ω–Ω—è–º –∫–æ–∂–Ω–æ–≥–æ —Ñ–∞–π–ª—É
- ‚úÖ Manual testing –ø—ñ—Å–ª—è –∫–æ–∂–Ω–æ—ó –∑–º—ñ–Ω–∏
- ‚úÖ Git commit –ø—ñ—Å–ª—è –∫–æ–∂–Ω–æ–≥–æ –∫—Ä–æ–∫—É
- ‚úÖ –ú–æ–∂–ª–∏–≤—ñ—Å—Ç—å rollback

---

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è

**–î–õ–Ø –ó–ê–†–ê–ó:** –ü–æ—á–∞—Ç–∏ –∑ **–ú—ñ–Ω—ñ–º–∞–ª—å–Ω–æ–≥–æ –ü–ª–∞–Ω—É** (20 —Ö–≤, SAFE)

**–ß–æ–º—É:**
- ‚úÖ –®–≤–∏–¥–∫–æ (20 —Ö–≤)
- ‚úÖ –ë–µ–∑–ø–µ—á–Ω–æ (—Ç—ñ–ª—å–∫–∏ –≤–∏–¥–∞–ª–µ–Ω–Ω—è unused —Ñ–∞–π–ª—ñ–≤)
- ‚úÖ –í—ñ–¥—á—É—Ç–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç (-23K LOC)
- ‚úÖ –õ–µ–≥–∫–æ –ø—Ä–æ—Ç–µ—Å—Ç—É–≤–∞—Ç–∏
- ‚úÖ –ú–æ–∂–Ω–∞ –∑—Ä–æ–±–∏—Ç–∏ –ø–æ–≤–Ω–∏–π –ø–ª–∞–Ω –ø—ñ–∑–Ω—ñ—à–µ

**–ü—ñ—Å–ª—è –º—ñ–Ω—ñ–º–∞–ª—å–Ω–æ–≥–æ –ø–ª–∞–Ω—É:** –ü—Ä–∏–π–Ω—è—Ç–∏ —Ä—ñ—à–µ–Ω–Ω—è —á–∏ –ø—Ä–æ–¥–æ–≤–∂—É–≤–∞—Ç–∏ –∑ –ø–æ–≤–Ω–∏–º –ø–ª–∞–Ω–æ–º.

---

## üìä –ù–∞—Å—Ç—É–ø–Ω—ñ –ö—Ä–æ–∫–∏

### –ó–∞—Ä–∞–∑:
1. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —â–æ v4 —Ñ–∞–π–ª–∏ —Ç–∞ atlas-voice-system-v2.js –ù–ï —ñ–º–ø–æ—Ä—Ç—É—é—Ç—å—Å—è
2. –í–∏–¥–∞–ª–∏—Ç–∏ legacy —Ñ–∞–π–ª–∏
3. –í–∏–¥–∞–ª–∏—Ç–∏ –ø—É—Å—Ç—É –ø–∞–ø–∫—É managers/
4. –ü—Ä–æ—Ç–µ—Å—Ç—É–≤–∞—Ç–∏ —Å–∏—Å—Ç–µ–º—É

### –ü—ñ—Å–ª—è:
- –û—Ü—ñ–Ω–∏—Ç–∏ —á–∏ –ø–æ—Ç—Ä—ñ–±–µ–Ω –ø–æ–≤–Ω–∏–π –ø–ª–∞–Ω
- –°—Ç–≤–æ—Ä–∏—Ç–∏ –∑–≤—ñ—Ç –ø—Ä–æ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è
- –û–Ω–æ–≤–∏—Ç–∏ copilot-instructions.md

---

**–°—Ç–≤–æ—Ä–µ–Ω–æ:** 11 –∂–æ–≤—Ç–Ω—è 2025, ~21:50  
**–ê–≤—Ç–æ—Ä:** GitHub Copilot  
**–í–µ—Ä—Å—ñ—è:** 1.0.0  
**–°—Ç–∞—Ç—É—Å:** üìä –ê–ù–ê–õ–Ü–ó –ó–ê–í–ï–†–®–ï–ù–û - –û–ß–Ü–ö–£–Ñ –ü–Ü–î–¢–í–ï–†–î–ñ–ï–ù–ù–Ø
