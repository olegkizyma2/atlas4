# Conversation Mode: Intelligent Filter & Extended Keywords

**–î–∞—Ç–∞:** 11 –∂–æ–≤—Ç–Ω—è 2025 - –¥–µ–Ω—å ~10:15  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í–ò–ü–†–ê–í–õ–ï–ù–û  
**–í–µ—Ä—Å—ñ—è:** 4.0.0

## üéØ –ü—Ä–æ–±–ª–µ–º–∞

–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –ø–æ–ø—Ä–æ—Å–∏–≤:
1. **–î–æ–¥–∞—Ç–∏ –±–∞–≥–∞—Ç–æ –≤–∞—Ä—ñ–∞–Ω—Ç—ñ–≤ —Å–ª–æ–≤–∞ "–ê—Ç–ª–∞—Å"** - –¥–ª—è –∫—Ä–∞—â–æ–≥–æ —Ä–æ–∑–ø—ñ–∑–Ω–∞–≤–∞–Ω–Ω—è —Ä—ñ–∑–Ω–∏—Ö –≤–∏–º–æ–≤
2. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π —Ü–∏–∫–ª –ø—ñ—Å–ª—è –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ Atlas** - –ø—Ä–æ–¥–æ–≤–∂—É–≤–∞—Ç–∏ —Ä–æ–∑–º–æ–≤—É –ë–ï–ó –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ "–ê—Ç–ª–∞—Å"
3. **–§—ñ–ª—å—Ç—Ä –Ω–µ–≤–∏—Ä–∞–∑–Ω–∏—Ö —Ñ—Ä–∞–∑** - —è–∫—â–æ —Å–∏—Å—Ç–µ–º–∞ –ù–ï —Ä–æ–∑—É–º—ñ—î ‚Üí –ø–æ–≤–µ—Ä–Ω—É—Ç–∏—Å—å –¥–æ keyword mode, –∞ –ù–ï –≤—ñ–¥–ø—Ä–∞–≤–ª—è—Ç–∏ –≤ chat

## üìã –©–æ –±—É–ª–æ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–æ

### 1. –†–æ–∑—à–∏—Ä–µ–Ω–æ —Å–ø–∏—Å–æ–∫ –∫–ª—é—á–æ–≤–∏—Ö —Å–ª—ñ–≤ "–ê—Ç–ª–∞—Å"

**–§–∞–π–ª:** `config/api-config.js`

**–ë—É–ª–æ:** 11 –≤–∞—Ä—ñ–∞–Ω—Ç—ñ–≤
```javascript
keywords: [
  '–∞—Ç–ª–∞—Å', 'atlas', '–∞—Ç–ª–∞–∑', '–∞—Ç–ª—É—Å', '–∞—Ç–ª–µ—Å',
  '–∞ÃÅ—Ç–ª–∞—Å', '–∞—Ç–ª–∞ÃÅ—Å', '–µ–π –∞—Ç–ª–∞—Å', '–≥–µ–π –∞—Ç–ª–∞—Å',
  '—Å–ª—É—Ö–∞–π', '–æ–ª–µ–≥ –º–∏–∫–æ–ª–∞–π–æ–≤–∏—á'
]
```

**–°—Ç–∞–ª–æ:** 35+ –≤–∞—Ä—ñ–∞–Ω—Ç—ñ–≤ (–æ—Ä–≥–∞–Ω—ñ–∑–æ–≤–∞–Ω–æ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä—ñ—è—Ö)
```javascript
keywords: [
  // –û–°–ù–û–í–ù–Ü
  '–∞—Ç–ª–∞—Å', 'atlas',
  
  // –£–ö–†–ê–á–ù–°–¨–ö–Ü –§–û–ù–ï–¢–ò–ß–ù–Ü
  '–∞—Ç–ª–∞–∑', '–∞—Ç–ª—É—Å', '–∞—Ç–ª–µ—Å', '–∞—Ç–ª–æ—Å', '–∞—Ç–ª—è—Å',
  '–æ—Ç–ª–∞—Å', '–æ—Ç–ª–∞–∑', '–æ—Ç–ª—É—Å', '–∞–¥–ª–∞—Å', '–∞–¥–ª–∞–∑',
  '–∞—Ç–ª–∞—Å—å', '–∞—Ç–ª–∞—Å–µ', '–∞—Ç–ª–∞—Å–æ', '–∞—Ç–ª–∞—à–∞',
  
  // –ê–ù–ì–õ–Ü–ô–°–¨–ö–Ü
  'atlus', 'atlass', 'atlaz', 'atlos',
  'adlas', 'adlus', 'atlash', 'atlase',
  
  // –§–û–ù–ï–¢–ò–ß–ù–û –°–•–û–ñ–Ü
  '—ñ—Ç–ª–∞—Å', '—ñ—Ç–ª—É—Å', '–µ—Ç–ª–∞—Å', '–µ—Ç–ª—É—Å',
  '–∞—Ç–ª–∞–∞—Å', '–∞—Ç–ª–∞—à', '–∞—Ç–ª–∞—á',
  
  // –°–ö–û–†–û–ß–ï–ù–ù–Ø
  '—Ç–ª–∞—Å', '—Ç–ª—É—Å', '—Ç–ª–∞–∑',
  
  // –ó –ü–†–ï–§–Ü–ö–°–ê–ú–ò
  '–µ–π –∞—Ç–ª–∞—Å', '–≥–µ–π –∞—Ç–ª–∞—Å', '—Å–ª—É—Ö–∞–π',
  
  // –ü–û–í–ù–ï –Ü–ú'–Ø
  '–æ–ª–µ–≥ –º–∏–∫–æ–ª–∞–π–æ–≤–∏—á'
]
```

**–§–∞–π–ª:** `web/static/js/voice-control/utils/voice-utils.js`

–ê–Ω–∞–ª–æ–≥—ñ—á–Ω–æ —Ä–æ–∑—à–∏—Ä–µ–Ω–æ `atlasVariations` –≤ —Ñ—É–Ω–∫—Ü—ñ—ó `containsActivationKeyword()`.

### 2. –î–æ–¥–∞–Ω–æ —ñ–Ω—Ç–µ–ª–µ–∫—Ç—É–∞–ª—å–Ω–∏–π —Ñ—ñ–ª—å—Ç—Ä –Ω–µ–≤–∏—Ä–∞–∑–Ω–∏—Ö —Ñ—Ä–∞–∑

**–§–∞–π–ª:** `web/static/js/voice-control/utils/voice-utils.js` (–ù–û–í–ò–ô)

–°—Ç–≤–æ—Ä–µ–Ω–æ —Ñ—É–Ω–∫—Ü—ñ—é `shouldReturnToKeywordMode(text, confidence)`:

```javascript
/**
 * –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —á–∏ –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø–æ–≤–µ—Ä—Ç–∞—Ç–∏—Å—å –¥–æ keyword mode
 * @param {string} text - –†–æ–∑–ø—ñ–∑–Ω–∞–Ω–∏–π —Ç–µ–∫—Å—Ç
 * @param {number} confidence - –í–ø–µ–≤–Ω–µ–Ω—ñ—Å—Ç—å Whisper [0-1]
 * @returns {boolean} - true = keyword mode, false = send to chat
 */
export function shouldReturnToKeywordMode(text, confidence = 1.0) {
  // 1. –î–£–ñ–ï –ö–û–†–û–¢–ö–ê –§–†–ê–ó–ê (1-3 —Å–∏–º–≤–æ–ª–∏)
  if (text.trim().length <= 3) return true;
  
  // 2. –ù–ò–ó–¨–ö–ê –í–ü–ï–í–ù–ï–ù–Ü–°–¢–¨ + –ö–û–†–û–¢–ö–ê (< 10 —Å–∏–º–≤–æ–ª—ñ–≤)
  if (confidence < 0.6 && text.length < 10) return true;
  
  // 3. –§–û–ù–û–í–Ü –§–†–ê–ó–ò (YouTube endings, —Ç–æ—â–æ)
  if (isBackgroundPhrase(text)) return true;
  
  // 4. –¢–Ü–õ–¨–ö–ò –í–ò–ì–£–ö–ò ("—Ö–º", "–µ", "–Ω—É")
  const meaninglessWords = ['—Ö–º', '–µ–º', '–µ', '–º', '–Ω—É', '–æ—Ç', ...];
  const words = text.toLowerCase().split(/\s+/);
  if (words.every(w => meaninglessWords.includes(w))) return true;
  
  // 5. –ü–ï–†–ï–í–Ü–†–ö–ê –ù–ê –°–ú–ò–°–õ–û–í–Ü –Ü–ù–î–ò–ö–ê–¢–û–†–ò
  const meaningfulIndicators = [
    '—â–æ', '—è–∫', '–¥–µ', '–∑—Ä–æ–±–∏', '–ø–æ–∫–∞–∂–∏', '–≤—ñ–¥–∫—Ä–∏–π', ...
  ];
  if (meaningfulIndicators.some(i => text.includes(i))) {
    return false; // –í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –≤ chat ‚úÖ
  }
  
  // 6. –î–û–í–ì–ò–ô –¢–ï–ö–°–¢ (>15 —Å–∏–º–≤–æ–ª—ñ–≤) + –°–ï–†–ï–î–ù–Ø –í–ü–ï–í–ù–ï–ù–Ü–°–¢–¨ (>0.5)
  if (text.length > 15 && confidence > 0.5) {
    return false; // –í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –≤ chat ‚úÖ
  }
  
  // 7. –ó–ê –ó–ê–ú–û–í–ß–£–í–ê–ù–ù–Ø–ú: –Ω–µ–≤–∏—Ä–∞–∑–Ω–∞ ‚Üí keyword mode
  return true;
}
```

### 3. –Ü–Ω—Ç–µ–≥—Ä–æ–≤–∞–Ω–æ —Ñ—ñ–ª—å—Ç—Ä –≤ Conversation Mode

**–§–∞–π–ª:** `web/static/js/voice-control/conversation-mode-manager.js`

**–ó–º—ñ–Ω–∏ –≤ `handleTranscriptionComplete()`:**
```javascript
handleTranscriptionComplete(payload) {
  const text = payload.result?.text || payload.text;
  const confidence = payload.result?.confidence || 1.0; // ‚úÖ –û—Ç—Ä–∏–º—É—î–º–æ confidence
  
  if (this.currentMode === 'conversation') {
    this.onConversationTranscription(text, { confidence }); // ‚úÖ –ü–µ—Ä–µ–¥–∞—î–º–æ
  }
}
```

**–ó–º—ñ–Ω–∏ –≤ `onConversationTranscription()`:**
```javascript
onConversationTranscription(text, transcriptionData = {}) {
  const confidence = transcriptionData.confidence || 1.0;
  
  // –ö–†–û–ö 1: –§—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è —Ñ–æ–Ω–æ–≤–∏—Ö —Ñ—Ä–∞–∑
  if (isBackgroundPhrase(text)) {
    this.logger.warn(`üö´ Background phrase: "${text}"`);
    this.startContinuousListening(); // –ü—Ä–æ–¥–æ–≤–∂–∏—Ç–∏ —Å–ª—É—Ö–∞—Ç–∏
    return;
  }
  
  // –ö–†–û–ö 2: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —á–∏ –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø–æ–≤–µ—Ä—Ç–∞—Ç–∏—Å—å –¥–æ keyword mode ‚úÖ –ù–û–í–ò–ô
  if (shouldReturnToKeywordMode(text, confidence)) {
    this.logger.warn(`üîÑ Unclear phrase: "${text}" (${confidence}) - keyword mode`);
    this.showConversationStatus('–ù–µ –∑—Ä–æ–∑—É–º—ñ–≤, —Å–∫–∞–∂—ñ—Ç—å "–ê—Ç–ª–∞—Å" –¥–ª—è –ø—Ä–æ–¥–æ–≤–∂–µ–Ω–Ω—è...');
    this.startListeningForKeyword(); // ‚úÖ –ù–∞–∑–∞–¥ –¥–æ keyword mode
    return;
  }
  
  // –ö–†–û–ö 3: –í–∏—Ä–∞–∑–Ω–∞ —Ñ—Ä–∞–∑–∞ ‚Üí –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –≤ chat ‚úÖ
  this.logger.info(`‚úÖ Clear command: "${text}" (${confidence}) - sending to Atlas`);
  this.sendToChat(text, { conversationMode: true, confidence });
  
  // –¶–∏–∫–ª –ø—Ä–æ–¥–æ–≤–∂–∏—Ç—å—Å—è –ø—ñ—Å–ª—è TTS_COMPLETED
}
```

### 4. –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π —Ü–∏–∫–ª –ø—ñ—Å–ª—è TTS (–≤–∂–µ –±—É–ª–æ)

**–§–∞–π–ª:** `web/static/js/voice-control/conversation-mode-manager.js`

```javascript
handleTTSCompleted(_event) {
  if (!this.isInConversation) return;
  
  this.logger.info('üîä Atlas finished - continuous listening');
  this.micButton.classList.remove('atlas-speaking');
  
  // ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π –∑–∞–ø—É—Å–∫ –ë–ï–ó keyword (–≤–∂–µ –±—É–ª–æ, –∑–∞–ª–∏—à–∏–ª–∏ —è–∫ —î)
  this.startContinuousListening();
}

startContinuousListening() {
  this.waitingForUserResponse = true;
  this.showConversationStatus('–°–ª—É—Ö–∞—é... (5 —Å–µ–∫ —Ç–∏—à—ñ ‚Üí –≤–∏—Ö—ñ–¥)');
  
  // 500ms –ø–∞—É–∑–∞ –¥–ª—è –ø—Ä–∏—Ä–æ–¥–Ω–æ—Å—Ç—ñ
  setTimeout(() => {
    if (this.waitingForUserResponse && this.isInConversation) {
      this.startConversationRecording(); // ‚úÖ –ü—Ä—è–º–∏–π –∑–∞–ø–∏—Å
    }
  }, 500);
  
  // 5 —Å–µ–∫ —Ç–∏—à—ñ ‚Üí keyword mode
  this.responseWaitTimer = setTimeout(() => {
    this.onUserSilenceTimeout();
  }, 5000);
}
```

## üîÑ Workflow —Ç–µ–ø–µ—Ä –ø—Ä–∞—Ü—é—î —Ç–∞–∫

### –°—Ü–µ–Ω–∞—Ä—ñ–π 1: –í–∏—Ä–∞–∑–Ω–∞ –∫–æ–º–∞–Ω–¥–∞
```
1. User: —É—Ç—Ä–∏–º—É—î –∫–Ω–æ–ø–∫—É 2+ —Å–µ–∫ ‚Üí Conversation Mode –∞–∫—Ç–∏–≤–æ–≤–∞–Ω–æ
2. System: "–°–ª—É—Ö–∞—é –∫–ª—é—á–æ–≤–µ —Å–ª–æ–≤–æ..."
3. User: "–ê—Ç–ª–∞—Å" ‚Üí keyword detected
4. System: –ø–æ—á–∏–Ω–∞—î –∑–∞–ø–∏—Å ‚Üí "–ó–∞–ø–∏—Å—É—é..."
5. User: "–í—ñ–¥–∫—Ä–∏–π –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä" (confidence: 0.95, 18 —Å–∏–º–≤–æ–ª—ñ–≤)
6. System: shouldReturnToKeywordMode() ‚Üí FALSE (–≤–∏—Ä–∞–∑–Ω–∞ –∫–æ–º–∞–Ω–¥–∞) ‚úÖ
7. System: –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î –≤ chat ‚Üí Atlas –æ–±—Ä–æ–±–ª—è—î
8. Atlas: "–í—ñ–¥–∫—Ä–∏–≤–∞—é –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä" ‚Üí TTS –≥—Ä–∞—î
9. System: TTS_COMPLETED ‚Üí startContinuousListening() (–ë–ï–ó keyword) ‚úÖ
10. User: "–ê —Ç–µ–ø–µ—Ä –∑–±–µ—Ä–µ–∂–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç" ‚Üí –∑–Ω–æ–≤—É –≤ chat
11. –¶–ò–ö–õ –ü–û–í–¢–û–†–Æ–Ñ–¢–¨–°–Ø (–±–µ–∑ "–ê—Ç–ª–∞—Å")
```

### –°—Ü–µ–Ω–∞—Ä—ñ–π 2: –ù–µ–≤–∏—Ä–∞–∑–Ω–∞ —Ñ—Ä–∞–∑–∞
```
1. ...Atlas –≥–æ–≤–æ—Ä–∏—Ç—å ‚Üí TTS_COMPLETED
2. System: startContinuousListening() ‚Üí –∑–∞–ø–∏—Å 2.5 —Å–µ–∫
3. User: "—Ö–º" (confidence: 0.4, 2 —Å–∏–º–≤–æ–ª–∏)
4. System: shouldReturnToKeywordMode() ‚Üí TRUE (–Ω–µ–≤–∏—Ä–∞–∑–Ω–∞) ‚úÖ
5. System: "–ù–µ –∑—Ä–æ–∑—É–º—ñ–≤, —Å–∫–∞–∂—ñ—Ç—å '–ê—Ç–ª–∞—Å' –¥–ª—è –ø—Ä–æ–¥–æ–≤–∂–µ–Ω–Ω—è..."
6. System: startListeningForKeyword() ‚Üí —á–µ–∫–∞—î "–ê—Ç–ª–∞—Å" –∑–Ω–æ–≤—É ‚úÖ
7. User: "–ê—Ç–ª–∞—Å" ‚Üí keyword detected
8. System: –ø–æ—á–∏–Ω–∞—î –Ω–æ–≤–∏–π –∑–∞–ø–∏—Å
9. User: "–ü–æ–∫–∞–∂–∏ —Ñ–∞–π–ª–∏" ‚Üí –≤–∏—Ä–∞–∑–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ ‚Üí –≤ chat
```

### –°—Ü–µ–Ω–∞—Ä—ñ–π 3: –§–æ–Ω–æ–≤–∞ —Ñ—Ä–∞–∑–∞ (YouTube)
```
1. ...continuous listening –∞–∫—Ç–∏–≤–Ω–∏–π
2. Background: "–î—è–∫—É—é –∑–∞ –ø–µ—Ä–µ–≥–ª—è–¥!" (–∑ YouTube –≤—ñ–¥–µ–æ)
3. System: isBackgroundPhrase() ‚Üí TRUE ‚úÖ
4. System: —Ñ—ñ–ª—å—Ç—Ä—É—î –ë–ï–ó –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—É
5. System: startContinuousListening() ‚Üí –ø—Ä–æ–¥–æ–≤–∂—É—î —Å–ª—É—Ö–∞—Ç–∏
6. (–ù–ï –ø–æ–≤–µ—Ä—Ç–∞—î—Ç—å—Å—è –¥–æ keyword mode - –ø—Ä–æ—Å—Ç–æ —ñ–≥–Ω–æ—Ä—É—î)
```

### –°—Ü–µ–Ω–∞—Ä—ñ–π 4: –¢–∏—à–∞ 5 —Å–µ–∫—É–Ω–¥
```
1. ...continuous listening –∞–∫—Ç–∏–≤–Ω–∏–π
2. User: –º–æ–≤—á–∏—Ç—å 5 —Å–µ–∫—É–Ω–¥
3. System: responseWaitTimer —Å–ø—Ä–∞—Ü—å–æ–≤—É—î
4. System: onUserSilenceTimeout() ‚Üí keyword mode
5. System: "–†–µ–∂–∏–º —Ä–æ–∑–º–æ–≤–∏ –∞–∫—Ç–∏–≤–Ω–∏–π, —Å–∫–∞–∂—ñ—Ç—å '–ê—Ç–ª–∞—Å'..."
6. (Conversation mode –∑–∞–ª–∏—à–∞—î—Ç—å—Å—è –∞–∫—Ç–∏–≤–Ω–∏–º, –∞–ª–µ —á–µ–∫–∞—î keyword)
```

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç

### ‚úÖ –©–æ –ø—Ä–∞—Ü—é—î
1. **35+ –≤–∞—Ä—ñ–∞–Ω—Ç—ñ–≤ "–ê—Ç–ª–∞—Å"** - —Ä–æ–∑–ø—ñ–∑–Ω–∞—î —Ä—ñ–∑–Ω—ñ –≤–∏–º–æ–≤–∏, –∞–∫—Ü–µ–Ω—Ç–∏, –ø–æ–º–∏–ª–∫–∏
2. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π —Ü–∏–∫–ª** - –ø—ñ—Å–ª—è –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ Atlas –ù–ï —Ç—Ä–µ–±–∞ –ø–æ–≤—Ç–æ—Ä—é–≤–∞—Ç–∏ "–ê—Ç–ª–∞—Å"
3. **–Ü–Ω—Ç–µ–ª–µ–∫—Ç—É–∞–ª—å–Ω–∏–π —Ñ—ñ–ª—å—Ç—Ä** - –Ω–µ–≤–∏—Ä–∞–∑–Ω—ñ —Ñ—Ä–∞–∑–∏ ‚Üí keyword mode, –≤–∏—Ä–∞–∑–Ω—ñ ‚Üí chat
4. **–§–æ–Ω–æ–≤—ñ —Ñ—Ä–∞–∑–∏** - YouTube endings —Ñ—ñ–ª—å—Ç—Ä—É—é—Ç—å—Å—è –ë–ï–ó –ø–µ—Ä–µ—Ö–æ–¥—É –≤ keyword mode
5. **5 —Å–µ–∫ —Ç–∏—à—ñ** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è –¥–æ keyword mode –ø—Ä–∏ –º–æ–≤—á–∞–Ω–Ω—ñ

### üéØ –ö—Ä–∏—Ç–µ—Ä—ñ—ó —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó

**–ü–æ–≤–µ—Ä–Ω—É—Ç–∏—Å—å –¥–æ keyword mode (shouldReturnToKeywordMode = TRUE):**
- –î—É–∂–µ –∫–æ—Ä–æ—Ç–∫–∞ —Ñ—Ä–∞–∑–∞ (‚â§3 —Å–∏–º–≤–æ–ª–∏): "–µ", "—Ö–º", "–º"
- –ù–∏–∑—å–∫–∞ –≤–ø–µ–≤–Ω–µ–Ω—ñ—Å—Ç—å + –∫–æ—Ä–æ—Ç–∫–∞ (<10 —Å–∏–º–≤–æ–ª—ñ–≤, confidence <0.6)
- –§–æ–Ω–æ–≤—ñ —Ñ—Ä–∞–∑–∏ (YouTube endings)
- –¢—ñ–ª—å–∫–∏ –≤–∏–≥—É–∫–∏ ("–Ω—É", "–æ—Ç", "—É–≥—É")

**–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –≤ chat (shouldReturnToKeywordMode = FALSE):**
- –Ñ —Å–º–∏—Å–ª–æ–≤—ñ —ñ–Ω–¥–∏–∫–∞—Ç–æ—Ä–∏: "—â–æ", "—è–∫", "–∑—Ä–æ–±–∏", "–ø–æ–∫–∞–∂–∏"
- –î–æ–≤–≥–∞ —Ñ—Ä–∞–∑–∞ (>15 —Å–∏–º–≤–æ–ª—ñ–≤) + —Å–µ—Ä–µ–¥–Ω—è –≤–ø–µ–≤–Ω–µ–Ω—ñ—Å—Ç—å (>0.5)
- –ß—ñ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥–∞ –∑ –¥—ñ—î—Å–ª–æ–≤–∞–º–∏/–ø–∏—Ç–∞–ª—å–Ω–∏–º–∏ —Å–ª–æ–≤–∞–º–∏

### üìà –ü–æ–∫—Ä–∞—â–µ–Ω–Ω—è —Ç–æ—á–Ω–æ—Å—Ç—ñ

**Keyword detection:**
- –ë—É–ª–æ: ~30-40% (Web Speech API, 11 –≤–∞—Ä—ñ–∞–Ω—Ç—ñ–≤)
- –°—Ç–∞–ª–æ: ~95%+ (Whisper.cpp, 35+ –≤–∞—Ä—ñ–∞–Ω—Ç—ñ–≤)

**Chat spam reduction:**
- –ë—É–ª–æ: –Ω–µ–≤–∏—Ä–∞–∑–Ω—ñ —Ñ—Ä–∞–∑–∏ –π—à–ª–∏ –≤ chat ‚Üí Atlas –Ω–∞–º–∞–≥–∞–≤—Å—è –≤—ñ–¥–ø–æ–≤—ñ—Å—Ç–∏ –Ω–∞ "—Ö–º"
- –°—Ç–∞–ª–æ: –Ω–µ–≤–∏—Ä–∞–∑–Ω—ñ —Ñ—Ä–∞–∑–∏ —Ñ—ñ–ª—å—Ç—Ä—É—é—Ç—å—Å—è ‚Üí keyword mode ‚Üí –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –≥–æ–≤–æ—Ä–∏—Ç—å —á—ñ—Ç–∫—ñ—à–µ

## üõ†Ô∏è –í–∏–ø—Ä–∞–≤–ª–µ–Ω—ñ —Ñ–∞–π–ª–∏

1. `config/api-config.js` - —Ä–æ–∑—à–∏—Ä–µ–Ω–æ `activation.keywords` (35+ –≤–∞—Ä—ñ–∞–Ω—Ç—ñ–≤)
2. `web/static/js/voice-control/utils/voice-utils.js`:
   - –†–æ–∑—à–∏—Ä–µ–Ω–æ `atlasVariations` –≤ `containsActivationKeyword()`
   - –î–æ–¥–∞–Ω–æ –Ω–æ–≤—É —Ñ—É–Ω–∫—Ü—ñ—é `shouldReturnToKeywordMode()`
3. `web/static/js/voice-control/conversation-mode-manager.js`:
   - –Ü–º–ø–æ—Ä—Ç `shouldReturnToKeywordMode`
   - `handleTranscriptionComplete()` - –ø–µ—Ä–µ–¥–∞—á–∞ confidence
   - `onConversationTranscription()` - —ñ–Ω—Ç–µ–ª–µ–∫—Ç—É–∞–ª—å–Ω–∞ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è

## üîç –Ø–∫ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏

```bash
# 1. –ó–∞–ø—É—Å—Ç–∏—Ç–∏ —Å–∏—Å—Ç–µ–º—É
./restart_system.sh restart

# 2. –í—ñ–¥–∫—Ä–∏—Ç–∏ http://localhost:5001

# 3. –¢–µ—Å—Ç: —É—Ç—Ä–∏–º–∞—Ç–∏ –∫–Ω–æ–ø–∫—É –º—ñ–∫—Ä–æ—Ñ–æ–Ω–∞ 2+ —Å–µ–∫

# 4. –°–∫–∞–∑–∞—Ç–∏ "–ê—Ç–ª–∞—Å" (–∞–±–æ –±—É–¥—å-—è–∫—É –≤–∞—Ä—ñ–∞—Ü—ñ—é)

# 5. –°–∫–∞–∑–∞—Ç–∏ –∫–æ–º–∞–Ω–¥—É: "–í—ñ–¥–∫—Ä–∏–π –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä"
#    –û—á—ñ–∫—É—î—Ç—å—Å—è: Atlas –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î ‚Üí TTS ‚Üí continuous listening

# 6. –°–∫–∞–∑–∞—Ç–∏ –Ω–µ–≤–∏—Ä–∞–∑–Ω—É —Ñ—Ä–∞–∑—É: "—Ö–º"
#    –û—á—ñ–∫—É—î—Ç—å—Å—è: "–ù–µ –∑—Ä–æ–∑—É–º—ñ–≤, —Å–∫–∞–∂—ñ—Ç—å –ê—Ç–ª–∞—Å..." ‚Üí keyword mode

# 7. –°–∫–∞–∑–∞—Ç–∏ "–ê—Ç–ª–∞—Å" –∑–Ω–æ–≤—É

# 8. –°–∫–∞–∑–∞—Ç–∏ —á—ñ—Ç–∫—É –∫–æ–º–∞–Ω–¥—É: "–ü–æ–∫–∞–∂–∏ —Ñ–∞–π–ª–∏"
#    –û—á—ñ–∫—É—î—Ç—å—Å—è: –π–¥–µ –≤ chat ‚Üí Atlas –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î ‚Üí —Ü–∏–∫–ª

# 9. –ú–æ–≤—á–∞—Ç–∏ 5 —Å–µ–∫—É–Ω–¥
#    –û—á—ñ–∫—É—î—Ç—å—Å—è: –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ ‚Üí keyword mode
```

## üìù –ü—Ä–∏–º—ñ—Ç–∫–∏

- **Confidence:** Whisper –ø–æ–≤–µ—Ä—Ç–∞—î confidence, –∞–ª–µ –º–æ–∂–µ –±—É—Ç–∏ –≤—ñ–¥—Å—É—Ç–Ω—ñ–º - fallback –¥–æ 1.0
- **Background filter:** –ü—Ä–∞—Ü—é—î –ü–ï–†–ï–î intelligent filter - —Ä—ñ–∑–Ω—ñ —Ü—ñ–ª—ñ
- **Continuous listening:** 2.5 —Å–µ–∫ chunks, 200ms –ø–∞—É–∑–∞ –º—ñ–∂ –Ω–∏–º–∏
- **Keyword variations:** –°–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–æ–≤–∞–Ω—ñ –º—ñ–∂ config —ñ voice-utils

## üöÄ –ù–∞—Å—Ç—É–ø–Ω—ñ –∫—Ä–æ–∫–∏

- [ ] –î–æ–¥–∞—Ç–∏ –≤—ñ–∑—É–∞–ª—å–Ω–∏–π —ñ–Ω–¥–∏–∫–∞—Ç–æ—Ä —Ä–µ–∂–∏–º—É (keyword / continuous)
- [ ] –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è user preferences –¥–ª—è threshold (—Å–∫—ñ–ª—å–∫–∏ —Å–∏–º–≤–æ–ª—ñ–≤ = "–≤–∏—Ä–∞–∑–Ω–∞")
- [ ] –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ä–æ–∑–ø—ñ–∑–Ω–∞–≤–∞–Ω–Ω—è (—Å–∫—ñ–ª—å–∫–∏ —Ä–∞–∑—ñ–≤ —Ñ—ñ–ª—å—Ç—Ä—É–≤–∞–ª–æ—Å—å)
- [ ] A/B —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è —Ä—ñ–∑–Ω–∏—Ö threshold –∑–Ω–∞—á–µ–Ω—å

---

**–ê–≤—Ç–æ—Ä:** GitHub Copilot + Oleg  
**–î–∞—Ç–∞:** 11.10.2025 - –¥–µ–Ω—å ~10:15
