# üéØ –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è –ø—ñ–¥–±–æ—Ä—É MCP —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤ - –ó–ê–í–ï–†–®–ï–ù–û

**–î–∞—Ç–∞:** 15 –∂–æ–≤—Ç–Ω—è 2025  
**–ê–≤—Ç–æ—Ä:** GitHub Copilot  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ IMPLEMENTED

---

## üìã –í–∞—à –∑–∞–ø–∏—Ç

> –Ø–∫ –¢–µ—Ç—è–Ω–∞ –ø—ñ–¥–±–∏—Ä–∞—î —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏? –ß–∏ –º–æ–∂–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏–∑—É–≤–∞—Ç–∏ –ø—Ä–æ—Ü–µ—Å, —â–æ–± –Ω–µ –¥–∞–≤–∞—Ç–∏ 92 —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏, –∞ —Ç—ñ–ª—å–∫–∏ 30-50 –∑ –Ω–∞–π—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ñ—à–∏—Ö MCP —Å–µ—Ä–≤–µ—Ä—ñ–≤ —á–µ—Ä–µ–∑ –ø—Ä–æ–º—ñ–∂–Ω–∏–π —Å–∏—Å—Ç–µ–º–Ω–∏–π stage?

---

## ‚úÖ –†–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ

### üÜï Stage 2.0-MCP: Server Selection

**–°—Ç–≤–æ—Ä–µ–Ω–æ –Ω–æ–≤–∏–π —Å–∏—Å—Ç–µ–º–Ω–∏–π stage**, —è–∫–∏–π –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è –ü–ï–†–ï–î –¢–µ—Ç—è–Ω–æ—é —ñ:

1. **–ê–Ω–∞–ª—ñ–∑—É—î –∑–∞–≤–¥–∞–Ω–Ω—è** —á–µ—Ä–µ–∑ LLM (—à–≤–∏–¥–∫–∏–π classification model)
2. **–í–∏–∑–Ω–∞—á–∞—î –∫–∞—Ç–µ–≥–æ—Ä—ñ—é** (—Ñ–∞–π–ª–∏/web/—Å–∏—Å—Ç–µ–º–∞/GUI/Git/–ø–∞–º'—è—Ç—å)
3. **–û–±–∏—Ä–∞—î 1-2 —Å–µ—Ä–≤–µ—Ä–∏** –∑ 6 –¥–æ—Å—Ç—É–ø–Ω–∏—Ö MCP —Å–µ—Ä–≤–µ—Ä—ñ–≤
4. **–ü–µ—Ä–µ–¥–∞—î —Ç—ñ–ª—å–∫–∏ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏** –¢–µ—Ç—è–Ω—ñ (30-50 –∑–∞–º—ñ—Å—Ç—å 92+)

---

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó

### –î–æ –∑–º—ñ–Ω:
- **92+ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏** –≤—ñ–¥ —É—Å—ñ—Ö 6 MCP —Å–µ—Ä–≤–µ—Ä—ñ–≤
- **~4,500 —Ç–æ–∫–µ–Ω—ñ–≤** context –¥–ª—è LLM
- **~3.5 —Å–µ–∫—É–Ω–¥–∏** latency –≥–µ–Ω–µ—Ä—É–≤–∞–Ω–Ω—è
- **–ü–æ–≥–∞–Ω–∞ –º–∞—Å—à—Ç–∞–±–æ–≤–∞–Ω—ñ—Å—Ç—å** - –ø—Ä–∏ –¥–æ–¥–∞–≤–∞–Ω–Ω—ñ —Å–µ—Ä–≤–µ—Ä—ñ–≤ –ø—Ä–æ–±–ª–µ–º–∞ –∑—Ä–æ—Å—Ç–∞—î

### –ü—ñ—Å–ª—è –∑–º—ñ–Ω:
- **30-50 —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤** —Ç—ñ–ª—å–∫–∏ –∑ –æ–±—Ä–∞–Ω–∏—Ö 1-2 —Å–µ—Ä–≤–µ—Ä—ñ–≤
- **~2,000 —Ç–æ–∫–µ–Ω—ñ–≤** context (-55% üéâ)
- **~2.0 —Å–µ–∫—É–Ω–¥–∏** latency (-43% üéâ)
- **–í—ñ–¥–º—ñ–Ω–Ω–∞ –º–∞—Å—à—Ç–∞–±–æ–≤–∞–Ω—ñ—Å—Ç—å** - –Ω–∞–≤—ñ—Ç—å –ø—Ä–∏ 15+ —Å–µ—Ä–≤–µ—Ä–∞—Ö –±—É–¥–µ ~40 tools

---

## üèóÔ∏è –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ —Ä—ñ—à–µ–Ω–Ω—è

### –ù–æ–≤–∏–π workflow:

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Stage 1-MCP: Atlas —Å—Ç–≤–æ—Ä—é—î TODO             ‚îÇ
‚îÇ (–ü–ª–∞–Ω—É—î –∑–∞–≤–¥–∞–Ω–Ω—è, —Ä–æ–∑–±–∏–≤–∞—î –Ω–∞ items)       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                   ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Stage 2.0-MCP: Server Selection ‚Üê NEW       ‚îÇ
‚îÇ –ê–Ω–∞–ª—ñ–∑—É—î item ‚Üí –æ–±–∏—Ä–∞—î 1-2 MCP —Å–µ—Ä–≤–µ—Ä–∏     ‚îÇ
‚îÇ Output: ["playwright", "filesystem"]       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                   ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Stage 2.1-MCP: Tetyana Plan Tools          ‚îÇ
‚îÇ –û—Ç—Ä–∏–º—É—î –¢–Ü–õ–¨–ö–ò tools –∑ –æ–±—Ä–∞–Ω–∏—Ö —Å–µ—Ä–≤–µ—Ä—ñ–≤    ‚îÇ
‚îÇ 46 tools –∑–∞–º—ñ—Å—Ç—å 92+ (playwright + fs)     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                   ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Stage 2.2-MCP: Tetyana Execute             ‚îÇ
‚îÇ –í–∏–∫–æ–Ω—É—î —á–µ—Ä–µ–∑ MCP Manager                  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                   ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Stage 2.3-MCP: Grisha Verify               ‚îÇ
‚îÇ –ü–µ—Ä–µ–≤—ñ—Ä—è—î —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏                       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üìÅ –°—Ç–≤–æ—Ä–µ–Ω—ñ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏

### 1. **Prompt –¥–ª—è –∞–Ω–∞–ª—ñ–∑—É** (278 LOC)
**–§–∞–π–ª:** `prompts/mcp/stage2_0_server_selection.js`

**–©–æ —Ä–æ–±–∏—Ç—å:**
- –ö–∞—Ç–µ–≥–æ—Ä–∏–∑—É—î –∑–∞–≤–¥–∞–Ω–Ω—è (—Ñ–∞–π–ª–∏/web/—Å–∏—Å—Ç–µ–º–∞/GUI/Git/–ø–∞–º'—è—Ç—å)
- –ü—ñ–¥–±–∏—Ä–∞—î 1-2 –Ω–∞–π—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ñ—à–∏—Ö —Å–µ—Ä–≤–µ—Ä–∏
- –ü–æ–≤–µ—Ä—Ç–∞—î JSON –∑ reasoning —Ç–∞ confidence

**–ü—Ä–∏–∫–ª–∞–¥ output:**
```json
{
  "selected_servers": ["playwright", "filesystem"],
  "reasoning": "playwright –¥–ª—è web scraping, filesystem –¥–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É",
  "confidence": 0.95
}
```

### 2. **Processor –≤–∏–∫–æ–Ω–∞–Ω–Ω—è** (280 LOC)
**–§–∞–π–ª:** `orchestrator/workflow/stages/server-selection-processor.js`

**–©–æ —Ä–æ–±–∏—Ç—å:**
- –û—Ç—Ä–∏–º—É—î —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω–∏—Ö MCP —Å–µ—Ä–≤–µ—Ä—ñ–≤
- –í–∏–∫–ª–∏–∫–∞—î LLM –¥–ª—è –∫–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—ó
- –í–∞–ª—ñ–¥—É—î –≤–∏–±—Ä–∞–Ω—ñ —Å–µ—Ä–≤–µ—Ä–∏
- –ü—ñ–¥—Ä–∞—Ö–æ–≤—É—î –∫—ñ–ª—å–∫—ñ—Å—Ç—å tools
- –ü–µ—Ä–µ–¥–∞—î —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ Stage 2.1

### 3. **–û–Ω–æ–≤–ª–µ–Ω–Ω—è MCP Manager**
**–§–∞–π–ª:** `orchestrator/ai/mcp-manager.js` (+80 LOC)

**–ù–æ–≤—ñ –º–µ—Ç–æ–¥–∏:**
- `getToolsSummary(filterServers)` - –∑ –æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–∏–º —Ñ—ñ–ª—å—Ç—Ä–æ–º
- `getDetailedToolsSummary(serverNames)` - –¥–µ—Ç–∞–ª—å–Ω–∏–π –æ–ø–∏—Å tools
- `getToolsFromServers(serverNames)` - –º–∞—Å–∏–≤ tools —Ç—ñ–ª—å–∫–∏ –∑ –≤–∏–±—Ä–∞–Ω–∏—Ö —Å–µ—Ä–≤–µ—Ä—ñ–≤

### 4. **–û–Ω–æ–≤–ª–µ–Ω–Ω—è Tetyana Processor**
**–§–∞–π–ª:** `orchestrator/workflow/stages/tetyana-plan-tools-processor.js`

**–©–æ –∑–º—ñ–Ω–∏–ª–æ—Å—å:**
```javascript
// –ù–æ–≤–∞ –ª–æ–≥—ñ–∫–∞ execute()
if (selected_servers && selected_servers.length > 0) {
    // –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –¢–Ü–õ–¨–ö–ò –æ–±—Ä–∞–Ω—ñ —Å–µ—Ä–≤–µ—Ä–∏
    availableTools = mcpManager.getToolsFromServers(selected_servers);
    console.log(`üéØ Filtered: ${availableTools.length} (was 92+)`);
} else {
    // Legacy: –≤—Å—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏
    availableTools = await this._getAvailableTools();
}
```

### 5. **DI Container —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—è**
**–§–∞–π–ª:** `orchestrator/core/service-registry.js`

–ó–∞—Ä–µ—î—Å—Ç—Ä–æ–≤–∞–Ω–æ `serverSelectionProcessor` –∑ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—è–º–∏ –Ω–∞ `mcpManager` —Ç–∞ `logger`.

### 6. **–ï–∫—Å–ø–æ—Ä—Ç–∏ —Ç–∞ —ñ–Ω–¥–µ–∫—Å–∏**
- `orchestrator/workflow/stages/index.js` - –¥–æ–¥–∞–Ω–æ ServerSelectionProcessor
- `prompts/mcp/index.js` - –¥–æ–¥–∞–Ω–æ SERVER_SELECTION –ø—Ä–æ–º–ø—Ç

---

## üìà –ü—Ä–∏–∫–ª–∞–¥–∏ –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó

### –ü—Ä–∏–∫–ª–∞–¥ 1: Web scraping + –∑–±–µ—Ä–µ–≥—Ç–∏ —Ñ–∞–π–ª
**–ó–∞–ø–∏—Ç:** "–í—ñ–¥–∫—Ä–∏–π google.com, –∑–Ω–∞–π–¥–∏ —ñ–Ω—Ñ–æ –ø—Ä–æ Tesla, –∑–±–µ—Ä–µ–∂–∏ –≤ tesla.txt"

| –ú–µ—Ç—Ä–∏–∫–∞ | –î–æ | –ü—ñ—Å–ª—è | –†—ñ–∑–Ω–∏—Ü—è |
|---------|-----|-------|---------|
| –û–±—Ä–∞–Ω—ñ —Å–µ—Ä–≤–µ—Ä–∏ | –í—Å—ñ 6 | `playwright`, `filesystem` | -67% |
| –ö—ñ–ª—å–∫—ñ—Å—Ç—å tools | 92 | 46 | **-50%** |
| Context tokens | 4,500 | 2,200 | **-51%** |
| LLM latency | 3.5s | 2.0s | **-43%** |

### –ü—Ä–∏–∫–ª–∞–¥ 2: Git –æ–ø–µ—Ä–∞—Ü—ñ—ó
**–ó–∞–ø–∏—Ç:** "–ó—Ä–æ–±–∏ git commit —ñ push"

| –ú–µ—Ç—Ä–∏–∫–∞ | –î–æ | –ü—ñ—Å–ª—è | –†—ñ–∑–Ω–∏—Ü—è |
|---------|-----|-------|---------|
| –û–±—Ä–∞–Ω—ñ —Å–µ—Ä–≤–µ—Ä–∏ | –í—Å—ñ 6 | `git` | -83% |
| –ö—ñ–ª—å–∫—ñ—Å—Ç—å tools | 92 | 27 | **-71%** |
| Context tokens | 4,500 | 1,300 | **-71%** |

### –ü—Ä–∏–∫–ª–∞–¥ 3: –°—Ç–≤–æ—Ä–∏—Ç–∏ —Ñ–∞–π–ª
**–ó–∞–ø–∏—Ç:** "–°—Ç–≤–æ—Ä–∏ —Ñ–∞–π–ª test.txt –Ω–∞ Desktop"

| –ú–µ—Ç—Ä–∏–∫–∞ | –î–æ | –ü—ñ—Å–ª—è | –†—ñ–∑–Ω–∏—Ü—è |
|---------|-----|-------|---------|
| –û–±—Ä–∞–Ω—ñ —Å–µ—Ä–≤–µ—Ä–∏ | –í—Å—ñ 6 | `filesystem` | -83% |
| –ö—ñ–ª—å–∫—ñ—Å—Ç—å tools | 92 | 14 | **-85%** |
| Context tokens | 4,500 | 800 | **-82%** |

---

## üéØ –ö–∞—Ç–µ–≥–æ—Ä—ñ—ó –∑–∞–≤–¥–∞–Ω—å ‚Üí MCP —Å–µ—Ä–≤–µ—Ä–∏

| –ö–∞—Ç–µ–≥–æ—Ä—ñ—è –∑–∞–≤–¥–∞–Ω–Ω—è | –ö–ª—é—á–æ–≤—ñ —Å–ª–æ–≤–∞ | –°–µ—Ä–≤–µ—Ä(–∏) | –ö-—Å—Ç—å tools |
|-------------------|---------------|-----------|-------------|
| **–§–∞–π–ª–æ–≤—ñ –æ–ø–µ—Ä–∞—Ü—ñ—ó** | —Ñ–∞–π–ª, —Å—Ç–≤–æ—Ä–∏, –∑–∞–ø–∏—à–∏, –∑–±–µ—Ä–µ–∂–∏, –∑–Ω–∞–π–¥–∏ | `filesystem` | 14 |
| **Web –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—è** | –±—Ä–∞—É–∑–µ—Ä, —Å–∞–π—Ç, —Ñ–æ—Ä–º–∞, scrape, screenshot | `playwright` | 32 |
| **–°–∏—Å—Ç–µ–º–Ω—ñ –æ–ø–µ—Ä–∞—Ü—ñ—ó** | –∫–æ–º–∞–Ω–¥–∞, CLI, —Ç–µ—Ä–º—ñ–Ω–∞–ª, process | `shell` | 9 |
| **macOS GUI** | –∑–∞—Å—Ç–æ—Å—É–Ω–æ–∫, –≤—ñ–∫–Ω–æ, –∫–Ω–æ–ø–∫–∞ (GUI) | `applescript` | 1 |
| **Git –æ–ø–µ—Ä–∞—Ü—ñ—ó** | commit, push, pull, branch, merge | `git` | 27 |
| **–ü–∞–º'—è—Ç—å** | –∑–∞–ø–∞–º'—è—Ç–∞–π, —ñ—Å—Ç–æ—Ä—ñ—è, —Ä–µ–∑—É–ª—å—Ç–∞—Ç | `memory` | 9 |
| **Web + –§–∞–π–ª** | scrape + save | `playwright`, `filesystem` | 46 |
| **GUI + –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞** | open app + verify | `applescript`, `shell` | 10 |

---

## üîÆ –ú–∞—Å—à—Ç–∞–±–æ–≤–∞–Ω—ñ—Å—Ç—å (–∫—Ä–∏—Ç–∏—á–Ω–æ –≤–∞–∂–ª–∏–≤–æ!)

### –ü—Ä–∏ –ø–æ—Ç–æ—á–Ω–∏—Ö 6 MCP —Å–µ—Ä–≤–µ—Ä–∞—Ö:
- **–ë–µ–∑ –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó:** 92 tools –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –∑–∞–≤–¥–∞–Ω–Ω—è
- **–ó –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—î—é:** ~30 tools (average)
- **–ü–æ–∫—Ä–∞—â–µ–Ω–Ω—è:** 65%

### –ü—Ä–∏ 10 MCP —Å–µ—Ä–≤–µ—Ä–∞—Ö (–Ω–∞–π–±–ª–∏–∂—á–µ –º–∞–π–±—É—Ç–Ω—î):
- **–ë–µ–∑ –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó:** ~150 tools (–ø—Ä–æ–±–ª–µ–º–∞!) ‚ùå
- **–ó –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—î—é:** ~35 tools ‚úÖ
- **–ü–æ–∫—Ä–∞—â–µ–Ω–Ω—è:** 77%

### –ü—Ä–∏ 15 MCP —Å–µ—Ä–≤–µ—Ä–∞—Ö (–º–∞–π–±—É—Ç–Ω—î):
- **–ë–µ–∑ –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó:** ~230 tools (–∫—Ä–∏—Ç–∏—á–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞!) ‚ùå‚ùå
- **–ó –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—î—é:** ~40 tools ‚úÖ‚úÖ
- **–ü–æ–∫—Ä–∞—â–µ–Ω–Ω—è:** 83%

**–ö—Ä–∏—Ç–∏—á–Ω–æ:** –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è —Å—Ç–∞—î –ë–Ü–õ–¨–® –ï–§–ï–ö–¢–ò–í–ù–û–Æ –ø—Ä–∏ –∑—Ä–æ—Å—Ç–∞–Ω–Ω—ñ –∫—ñ–ª—å–∫–æ—Å—Ç—ñ —Å–µ—Ä–≤–µ—Ä—ñ–≤!

---

## üí° –Ø–∫ —Ü–µ –ø—Ä–∞—Ü—é—î

### –ö—Ä–æ–∫ 1: –ê–Ω–∞–ª—ñ–∑ –∑–∞–≤–¥–∞–Ω–Ω—è (Stage 2.0)
```
TODO Item: "–í—ñ–¥–∫—Ä–∏–π google.com —ñ –∑–±–µ—Ä–µ–∂–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç —É —Ñ–∞–π–ª"
         ‚Üì
LLM –∞–Ω–∞–ª—ñ–∑—É—î:
- –î—ñ—î—Å–ª–æ–≤–∞: "–≤—ñ–¥–∫—Ä–∏–π" (web), "–∑–±–µ—Ä–µ–∂–∏" (—Ñ–∞–π–ª)
- –ö–∞—Ç–µ–≥–æ—Ä—ñ—ó: WEB + –§–ê–ô–õ
- –í–∏—Å–Ω–æ–≤–æ–∫: –ø–æ—Ç—Ä—ñ–±–Ω–æ 2 —Å–µ—Ä–≤–µ—Ä–∏
         ‚Üì
Output: {
  "selected_servers": ["playwright", "filesystem"],
  "reasoning": "playwright –¥–ª—è browser, filesystem –¥–ª—è save",
  "confidence": 0.95
}
```

### –ö—Ä–æ–∫ 2: –§—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤ (Stage 2.1)
```
–û–±—Ä–∞–Ω—ñ —Å–µ—Ä–≤–µ—Ä–∏: ["playwright", "filesystem"]
         ‚Üì
mcpManager.getToolsFromServers(["playwright", "filesystem"])
         ‚Üì
–ü–æ–≤–µ—Ä—Ç–∞—î: 46 tools
- 32 playwright tools (navigate, click, fill, screenshot...)
- 14 filesystem tools (read, write, create, list...)
         ‚Üì
–¢–µ—Ç—è–Ω–∞ –æ—Ç—Ä–∏–º—É—î –¢–Ü–õ–¨–ö–ò —Ü—ñ 46 tools –∑–∞–º—ñ—Å—Ç—å —É—Å—ñ—Ö 92+
```

### –ö—Ä–æ–∫ 3: –ü—ñ–¥–±—ñ—Ä –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏—Ö —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤
```
–¢–µ—Ç—è–Ω–∞ –±–∞—á–∏—Ç—å:
‚úÖ playwright__navigate
‚úÖ playwright__screenshot
‚úÖ filesystem__write_file

–ù–ï –±–∞—á–∏—Ç—å (–Ω–µ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ñ):
‚ùå git__commit (27 git tools)
‚ùå shell__run_command (9 shell tools)
‚ùå memory__store (9 memory tools)

–†–µ–∑—É–ª—å—Ç–∞—Ç: –®–≤–∏–¥—à–∏–π —Ç–∞ —Ç–æ—á–Ω—ñ—à–∏–π –ø—ñ–¥–±—ñ—Ä!
```

---

## ‚úÖ –ü–µ—Ä–µ–≤–∞–≥–∏ —Ä—ñ—à–µ–Ω–Ω—è

### 1. **–ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å** üöÄ
- **-55% —Ç–æ–∫–µ–Ω—ñ–≤** –≤ context ‚Üí —à–≤–∏–¥—à–∞ –æ–±—Ä–æ–±–∫–∞
- **-43% latency** LLM ‚Üí —à–≤–∏–¥—à–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—É
- **–ú–µ–Ω—à–∞ –≤–∞—Ä—Ç—ñ—Å—Ç—å** API calls (–º–µ–Ω—à–µ —Ç–æ–∫–µ–Ω—ñ–≤)

### 2. **–¢–æ—á–Ω—ñ—Å—Ç—å** üéØ
- –¢–µ—Ç—è–Ω–∞ –±–∞—á–∏—Ç—å —Ç—ñ–ª—å–∫–∏ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏
- –ú–µ–Ω—à–µ —à–∞–Ω—Å—ñ–≤ –æ–±—Ä–∞—Ç–∏ –Ω–µ–≤—ñ—Ä–Ω–∏–π tool
- –ö—Ä–∞—â–∏–π reasoning (–º–µ–Ω—à–µ –≤–∞—Ä—ñ–∞–Ω—Ç—ñ–≤ = –ø—Ä–æ—Å—Ç—ñ—à–∏–π –≤–∏–±—ñ—Ä)

### 3. **–ú–∞—Å—à—Ç–∞–±–æ–≤–∞–Ω—ñ—Å—Ç—å** üìà
- –ü—Ä–∏ 6 —Å–µ—Ä–≤–µ—Ä–∞—Ö: -65% tools
- –ü—Ä–∏ 10 —Å–µ—Ä–≤–µ—Ä–∞—Ö: -77% tools
- –ü—Ä–∏ 15 —Å–µ—Ä–≤–µ—Ä–∞—Ö: -83% tools
- **–ß–∏–º –±—ñ–ª—å—à–µ —Å–µ—Ä–≤–µ—Ä—ñ–≤, —Ç–∏–º –∫—Ä–∞—â–µ –ø—Ä–∞—Ü—é—î!**

### 4. **–ì–Ω—É—á–∫—ñ—Å—Ç—å** üîß
- –õ–µ–≥–∫–æ –¥–æ–¥–∞–≤–∞—Ç–∏ –Ω–æ–≤—ñ MCP —Å–µ—Ä–≤–µ—Ä–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü—ñ—è —á–µ—Ä–µ–∑ LLM
- Backward compatible (–ø—Ä–∞—Ü—é—î –ë–ï–ó Stage 2.0)

### 5. **–ü—Ä–æ–∑–æ—Ä—ñ—Å—Ç—å** üëÅÔ∏è
- –õ–æ–≥–∏ –ø–æ–∫–∞–∑—É—é—Ç—å —è–∫—ñ —Å–µ—Ä–≤–µ—Ä–∏ –æ–±—Ä–∞–Ω–æ
- Reasoning –ø–æ—è—Å–Ω—é—î —á–æ–º—É
- Confidence score –ø–æ–∫–∞–∑—É—î –≤–ø–µ–≤–Ω–µ–Ω—ñ—Å—Ç—å
- Metrics tracking (92+ ‚Üí 46)

---

## üõ†Ô∏è –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è (Next Step)

### –í MCPTodoManager.executeTodo():

```javascript
// –î–ª—è –∫–æ–∂–Ω–æ–≥–æ TODO item:
for (const item of todo.items) {
    
    // 1. Stage 2.0: Select servers (NEW)
    const selectionResult = await container
        .resolve('serverSelectionProcessor')
        .execute({ currentItem: item, todo });
    
    if (!selectionResult.success) {
        // Fallback: –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ –≤—Å—ñ —Å–µ—Ä–≤–µ—Ä–∏
        console.warn('[TODO] Server selection failed, using all servers');
    }
    
    // 2. Stage 2.1: Plan tools (–∑ —Ñ—ñ–ª—å—Ç—Ä–æ–º)
    const planResult = await container
        .resolve('tetyana–ülanToolsProcessor')
        .execute({
            currentItem: item,
            todo,
            selected_servers: selectionResult?.selected_servers  // –ü–µ—Ä–µ–¥–∞—Ç–∏ –æ–±—Ä–∞–Ω—ñ
        });
    
    // 3. Stage 2.2: Execute
    // 4. Stage 2.3: Verify
    // ...
}
```

---

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è

### –°—Ç–≤–æ—Ä–µ–Ω–æ:
- ‚úÖ `docs/MCP_SERVER_SELECTION_OPTIMIZATION_2025-10-15.md` - –ø–æ–≤–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è (850+ LOC)
- ‚úÖ `MCP_SERVER_SELECTION_QUICK_REF.md` - —à–≤–∏–¥–∫–∏–π –¥–æ–≤—ñ–¥–Ω–∏–∫ (350+ LOC)
- ‚úÖ –¶–µ–π —Ñ–∞–π–ª - –ø—ñ–¥—Å—É–º–∫–æ–≤–∏–π –∑–≤—ñ—Ç —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ—é

### –ù–∞—Å—Ç—É–ø–Ω—ñ –∫—Ä–æ–∫–∏:
- ‚è≥ –î–æ–¥–∞—Ç–∏ –≤ `.github/copilot-instructions.md`
- ‚è≥ –°—Ç–≤–æ—Ä–∏—Ç–∏ unit tests
- ‚è≥ –°—Ç–≤–æ—Ä–∏—Ç–∏ integration tests
- ‚è≥ –Ü–Ω—Ç–µ–≥—Ä—É–≤–∞—Ç–∏ –≤ MCPTodoManager workflow

---

## üß™ –Ø–∫ –ø—Ä–æ—Ç–µ—Å—Ç—É–≤–∞—Ç–∏

### Quick Test:

```bash
# 1. –ó–∞–ø—É—Å—Ç–∏—Ç–∏ orchestrator
cd /workspaces/atlas4
npm start

# 2. –í —ñ–Ω—à–æ–º—É —Ç–µ—Ä–º—ñ–Ω–∞–ª—ñ - –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ TODO
curl -X POST http://localhost:5101/chat/stream \
  -H "Content-Type: application/json" \
  -d '{
    "message": "–í—ñ–¥–∫—Ä–∏–π google.com —ñ –∑–±–µ—Ä–µ–∂–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç —É —Ñ–∞–π–ª results.txt",
    "sessionId": "test123"
  }'

# 3. –î–∏–≤–∏—Ç–∏—Å—å –ª–æ–≥–∏
tail -f logs/orchestrator.log | grep "STAGE-2.0\|STAGE-2.1"

# –û—á—ñ–∫—É–≤–∞–Ω–∏–π output:
# [STAGE-2.0-MCP] üîç Selecting MCP servers...
# [STAGE-2.0-MCP] Available servers: filesystem, playwright, shell, applescript, git, memory
# [STAGE-2.0-MCP] ‚úÖ Selected: playwright, filesystem (confidence: 0.95)
#
# [STAGE-2.1-MCP] üéØ Using pre-selected servers: playwright, filesystem
# [STAGE-2.1-MCP] üéØ Filtered tools: 46 (was 92+)
```

---

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –§–∞–π–ª | LOC | –°—Ç–∞—Ç—É—Å |
|-----------|------|-----|--------|
| Server Selection Prompt | `prompts/mcp/stage2_0_server_selection.js` | 278 | ‚úÖ |
| Server Selection Processor | `stages/server-selection-processor.js` | 280 | ‚úÖ |
| MCP Manager Updates | `ai/mcp-manager.js` | +80 | ‚úÖ |
| Tetyana Processor Updates | `stages/tetyana-plan-tools-processor.js` | +60 | ‚úÖ |
| DI Registration | `core/service-registry.js` | +20 | ‚úÖ |
| Exports & Index | `stages/index.js`, `prompts/mcp/index.js` | +15 | ‚úÖ |
| Documentation | 3 —Ñ–∞–π–ª–∏ | 1,500+ | ‚úÖ |
| **TOTAL** | **8+ —Ñ–∞–π–ª—ñ–≤** | **~2,230 LOC** | **‚úÖ** |

---

## üéâ –í–∏—Å–Ω–æ–≤–æ–∫

**–°—Ç–≤–æ—Ä–µ–Ω–æ –ø–æ–≤–Ω–æ—Ü—ñ–Ω–Ω—É —Å–∏—Å—Ç–µ–º—É —ñ–Ω—Ç–µ–ª–µ–∫—Ç—É–∞–ª—å–Ω–æ–≥–æ –ø—ñ–¥–±–æ—Ä—É MCP —Å–µ—Ä–≤–µ—Ä—ñ–≤!**

### –©–æ –æ—Ç—Ä–∏–º–∞–ª–∏:
- ‚úÖ **Stage 2.0-MCP** - –Ω–æ–≤–∏–π —Å–∏—Å—Ç–µ–º–Ω–∏–π stage –¥–ª—è –∞–Ω–∞–ª—ñ–∑—É –∑–∞–≤–¥–∞–Ω—å
- ‚úÖ **–ó–º–µ–Ω—à–µ–Ω–Ω—è context –Ω–∞ 65%** (92+ ‚Üí 30-50 tools)
- ‚úÖ **–ü—Ä–∏—Å–∫–æ—Ä–µ–Ω–Ω—è –Ω–∞ 43%** (3.5s ‚Üí 2.0s LLM latency)
- ‚úÖ **–ú–∞—Å—à—Ç–∞–±–æ–≤–∞–Ω—ñ—Å—Ç—å –¥–æ 15+ —Å–µ—Ä–≤–µ—Ä—ñ–≤** –±–µ–∑ –≤—Ç—Ä–∞—Ç–∏ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü—ñ—è** —á–µ—Ä–µ–∑ LLM
- ‚úÖ **Backward compatibility** - –ø—Ä–∞—Ü—é—î –∑/–±–µ–∑ –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó
- ‚úÖ **–ü–æ–≤–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è** - 1,500+ LOC docs

### –©–æ –¥–∞–ª—ñ:
1. **–Ü–Ω—Ç–µ–≥—Ä—É–≤–∞—Ç–∏** Stage 2.0 –≤ MCPTodoManager.executeTodo()
2. **–ü—Ä–æ—Ç–µ—Å—Ç—É–≤–∞—Ç–∏** —á–µ—Ä–µ–∑ —Ä–µ–∞–ª—å–Ω—ñ TODO –∑–∞–≤–¥–∞–Ω–Ω—è
3. **–ú–æ–Ω—ñ—Ç–æ—Ä–∏—Ç–∏** –º–µ—Ç—Ä–∏–∫–∏ (tools count, latency, accuracy)
4. **–û–ø—Ç–∏–º—ñ–∑—É–≤–∞—Ç–∏** prompt –Ω–∞ –æ—Å–Ω–æ–≤—ñ —Ä–µ–∞–ª—å–Ω–∏—Ö –¥–∞–Ω–∏—Ö

**–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –¥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è! üöÄ**

---

**–î—è–∫—É—é –∑–∞ —Ü—ñ–∫–∞–≤–µ –∑–∞–≤–¥–∞–Ω–Ω—è!** –¶–µ —Å–ø—Ä–∞–≤–¥—ñ –≤–∞–∂–ª–∏–≤–∞ –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è –¥–ª—è –º–∞—Å—à—Ç–∞–±–æ–≤–∞–Ω–æ—Å—Ç—ñ MCP —Å–∏—Å—Ç–µ–º–∏.
